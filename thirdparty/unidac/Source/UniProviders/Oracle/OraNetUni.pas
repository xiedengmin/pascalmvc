//////////////////////////////////////////////////
//  Oracle Data Access Components Net
//  Copyright (c) 1998-2019 Devart. All right reserved.
//  OraNet (OCI Lite)
//////////////////////////////////////////////////
{$I Odac.inc}
unit OraNetUni;
{$IFDEF NONET}
Error
{$ENDIF}
interface
{$IFDEF ODAC}
{$A+,C-,D-,G+,J-,L-,M-,O+,Y-,Z1}
{$ENDIF}
{$Q-,R-,W+}
uses
{$IFDEF UNIX}
cwstring,
{$ENDIF}
Classes,Types,SysUtils,
CRTypes,CRFunctions,CLRClasses,MemUtils,
{$IFNDEF UNIDACPRO}
OraCall,OraNumber,OraDateTime,OraInterval;
{$ELSE}
OraCallUni,OraNumberUni,OraDateTimeUni,OraIntervalUni;
{$ENDIF}
type
TSecurityLevel=(
slAccepted=0,
slRejected=1,
slRequested=2,
slRequired=3
);
var
UseDirectLobs:Boolean;
UseFastSelect:Boolean;
AdvancedSecurity:Boolean;
EncryptionLevel:TSecurityLevel;
DataIntegrityLevel:TSecurityLevel;
PacketSize:Integer;
SDU:Integer;
TDU:Integer;
OldAuthMode:Boolean;
OldAlterMode:Boolean;
OldRxdMode:Boolean;
function OCIAttrGet_(O0QO0Q0OQ0:pOCIHandle;OOQO0Q0OQ0:ub4;OQQO0Q0OQ0:IntPtr;
OCQO0Q0OQ0:pub4;O0CO0Q0OQ0:ub4;OOCO0Q0OQ0:pOCIError):sword;cdecl;
function OCIAttrGet2_(OQCO0Q0OQ0:pOCIHandle;OCCO0Q0OQ0:ub4;var O00QCQ0OQ0:Integer;
OO0QCQ0OQ0:pub4;OQ0QCQ0OQ0:ub4;OC0QCQ0OQ0:pOCIError):sword;cdecl;
function OCIAttrSet_(O0OQCQ0OQ0:pOCIHandle;OOOQCQ0OQ0:ub4;OQOQCQ0OQ0:IntPtr;
OCOQCQ0OQ0:ub4;O0QQCQ0OQ0:ub4;OOQQCQ0OQ0:pOCIError):sword;cdecl;
function OCIAttrSet2_(OQQQCQ0OQ0:pOCIHandle;OCQQCQ0OQ0:ub4;var O0CQCQ0OQ0:Integer;
OOCQCQ0OQ0:ub4;OQCQCQ0OQ0:ub4;OCCQCQ0OQ0:pOCIError):sword;cdecl;
function OCIBindArrayOfStruct_(O00CCQ0OQ0:pOCIBind;OO0CCQ0OQ0:pOCIError;OQ0CCQ0OQ0:ub4;
OC0CCQ0OQ0:ub4;O0OCCQ0OQ0:ub4;OOOCCQ0OQ0:ub4):sword;cdecl;
function OCIBindByName_(OQOCCQ0OQ0:pOCIStmt;var OCOCCQ0OQ0:pOCIBind;O0QCCQ0OQ0:pOCIError;
OOQCCQ0OQ0:IntPtr;OQQCCQ0OQ0:sb4;OCQCCQ0OQ0:IntPtr;O0CCCQ0OQ0:sb4;OOCCCQ0OQ0:ub2;
OQCCCQ0OQ0:IntPtr;OCCCCQ0OQ0:pub2;O000CQ0OQ0:pub2;OO00CQ0OQ0:ub4;OQ00CQ0OQ0:pub4;OC00CQ0OQ0:ub4):sword;cdecl;
function OCIBindDynamic_(O0O0CQ0OQ0:pOCIBind;OOO0CQ0OQ0:pOCIError;OQO0CQ0OQ0:IntPtr;OCO0CQ0OQ0:IntPtr;
O0Q0CQ0OQ0:IntPtr;OOQ0CQ0OQ0:IntPtr):sword;cdecl;
function OCIBindByPos_(OQQ0CQ0OQ0:pOCIStmt;var OCQ0CQ0OQ0:pOCIBind;O0C0CQ0OQ0:pOCIError;
OOC0CQ0OQ0:ub4;OQC0CQ0OQ0:IntPtr;OCC0CQ0OQ0:sb4;O00OCQ0OQ0:ub2;OO0OCQ0OQ0:IntPtr;
OQ0OCQ0OQ0:pub2;OC0OCQ0OQ0:pub2;O0OOCQ0OQ0:ub4;OOOOCQ0OQ0:pub4;OQOOCQ0OQ0:ub4):sword;cdecl;
function OCIBreak_(OCOOCQ0OQ0:pOCIHandle;O0QOCQ0OQ0:pOCIError):sword;cdecl;
function OCIDefineArrayOfStruct_(OOQOCQ0OQ0:pOCIDefine;OQQOCQ0OQ0:pOCIError;OCQOCQ0OQ0:ub4;
O0COCQ0OQ0:ub4;OOCOCQ0OQ0:ub4;OQCOCQ0OQ0:ub4):sword;cdecl;
function OCIDefineByPos_(OCCOCQ0OQ0:pOCIStmt;var O00QQQ0OQ0:pOCIDefine;OO0QQQ0OQ0:pOCIError;
OQ0QQQ0OQ0:ub4;OC0QQQ0OQ0:IntPtr;O0OQQQ0OQ0:sb4;OOOQQQ0OQ0:ub2;OQOQQQ0OQ0:IntPtr;OCOQQQ0OQ0:pub2;
O0QQQQ0OQ0:pub2;OOQQQQ0OQ0:ub4):sword;cdecl;
function OCIDefineDynamic_(OQQQQQ0OQ0:pOCIDefine;OCQQQQ0OQ0:pOCIError;O0CQQQ0OQ0:IntPtr;OOCQQQ0OQ0:IntPtr):sword;cdecl;
function OCIDescriptorAlloc_(OQCQQQ0OQ0:IntPtr;var OCCQQQ0OQ0:pOCIDescriptor;O00CQQ0OQ0:ub4;
OO0CQQ0OQ0:NativeUInt;OQ0CQQ0OQ0:IntPtr):sword;cdecl;
function OCIDescriptorFree_(OC0CQQ0OQ0:pOCIDescriptor;O0OCQQ0OQ0:ub4):sword;cdecl;
function OCIEnvCreate_(var OQOCQQ0OQ0:pOCIEnv;OCOCQQ0OQ0:ub4;const O0QCQQ0OQ0:IntPtr;
const OOQCQQ0OQ0:IntPtr;const OQQCQQ0OQ0:IntPtr;const OCQCQQ0OQ0:IntPtr;
O0CCQQ0OQ0:NativeUInt;OOCCQQ0OQ0:IntPtr):sword;cdecl;
function OCIErrorGet_(OQCCQQ0OQ0:pOCIHandle;OCCCQQ0OQ0:ub4;O000QQ0OQ0:IntPtr;var OO00QQ0OQ0:sb4;
OQ00QQ0OQ0:IntPtr;OC00QQ0OQ0:ub4;O0O0QQ0OQ0:ub4):sword;cdecl;
function OCIHandleAlloc_(OOQ0QQ0OQ0:IntPtr;var OQQ0QQ0OQ0:pOCIHandle;OCQ0QQ0OQ0:ub4;
O0C0QQ0OQ0:NativeUInt;OOC0QQ0OQ0:IntPtr):sword;cdecl;
function OCIHandleFree_(OQC0QQ0OQ0:pOCIHandle;OCC0QQ0OQ0:ub4):sword;cdecl;
function OCIParamGet_(OO0OQQ0OQ0:pOCIHandle;OQ0OQQ0OQ0:ub4;OC0OQQ0OQ0:pOCIError;
var O0OOQQ0OQ0:pOCIParam;OOOOQQ0OQ0:ub4):sword;cdecl;
function OCIPasswordChange_(OQOOQQ0OQ0:pOCISvcCtx;OCOOQQ0OQ0:pOCIError;const O0QOQQ0OQ0:IntPtr;
OOQOQQ0OQ0:ub4;const OQQOQQ0OQ0:IntPtr;OCQOQQ0OQ0:ub4;
const O0COQQ0OQ0:IntPtr;OOCOQQ0OQ0:sb4;OQCOQQ0OQ0:ub4):sword;cdecl;
function OCIServerAttach_(OCCOQQ0OQ0:pOCIServer;O00QOO0OQ0:pOCIError;OO0QOO0OQ0:IntPtr;
OQ0QOO0OQ0:sb4;OC0QOO0OQ0:ub4):sword;cdecl;
function OCIServerDetach_(OOOQOO0OQ0:pOCIServer;OQOQOO0OQ0:pOCIError;OCOQOO0OQ0:ub4):sword;cdecl;
function OCIServerVersion_(O0QQOO0OQ0:IntPtr;OOQQOO0OQ0:pOCIError;OQQQOO0OQ0:IntPtr;OCQQOO0OQ0:ub4;
O0CQOO0OQ0:ub1):sword;cdecl;
function OCISessionBegin_(OOCQOO0OQ0:pOCISvcCtx;OQCQOO0OQ0:pOCIError;OCCQOO0OQ0:pOCISession;
O00COO0OQ0:ub4;OO0COO0OQ0:ub4):sword;cdecl;
function OCISessionEnd_(OQ0COO0OQ0:pOCISvcCtx;OC0COO0OQ0:pOCIError;O0OCOO0OQ0:pOCISession;
OOOCOO0OQ0:ub4):sword;cdecl;
function OCIStmtExecute_(OQOCOO0OQ0:pOCISvcCtx;OCOCOO0OQ0:pOCIStmt;O0QCOO0OQ0:pOCIError;
OOQCOO0OQ0:ub4;OQQCOO0OQ0:ub4;OCQCOO0OQ0:pOCISnapshot;O0CCOO0OQ0:pOCISnapshot;
OOCCOO0OQ0:ub4):sword;cdecl;
function OCIStmtFetch_(OCCCOO0OQ0:pOCIStmt;O000OO0OQ0:pOCIError;OO00OO0OQ0:ub4;OQ00OO0OQ0:ub2;
OC00OO0OQ0:ub4):sword;cdecl;
function OCIStmtPrepare_(OOO0OO0OQ0:pOCIStmt;OQO0OO0OQ0:pOCIError;OCO0OO0OQ0:IntPtr;O0Q0OO0OQ0:ub4;
OOQ0OO0OQ0:ub4;OQQ0OO0OQ0:ub4):sword;cdecl;
function OCIStmtPrepare2_(O0C0OO0OQ0:pOCISvcCtx;var OOC0OO0OQ0:pOCIStmt;OQC0OO0OQ0:pOCIError;
OCC0OO0OQ0:IntPtr;O00OOO0OQ0:ub4;OO0OOO0OQ0:IntPtr;OQ0OOO0OQ0:ub4;OC0OOO0OQ0:ub4;
O0OOOO0OQ0:ub4):sword;cdecl;
function OCIStmtPrepare3_(OQOOOO0OQ0:pOCISvcCtx;OCOOOO0OQ0:pOCIStmt;O0QOOO0OQ0:pOCIError;
OOQOOO0OQ0:IntPtr;OQQOOO0OQ0:ub4;OCQOOO0OQ0:ub4;O0COOO0OQ0:ub4):sword;cdecl;
function OCIStmtGetNextResult_(OQCOOO0OQ0:pOCIStmt;OCCOOO0OQ0:pOCIError;
O00Q0O0OQ0:ppOCIStmt;out OO0Q0O0OQ0:ub4;OQ0Q0O0OQ0:ub4):sword;cdecl;
function OCITransCommit_(O0OQ0O0OQ0:pOCISvcCtx;OOOQ0O0OQ0:pOCIError;OQOQ0O0OQ0:ub4):sword;cdecl;
function OCITransRollback_(OCOQ0O0OQ0:pOCISvcCtx;O0QQ0O0OQ0:pOCIError;OOQQ0O0OQ0:ub4):sword;cdecl;
function OCILobCharSetForm_(OQQQ0O0OQ0:pOCIEnv;OCQQ0O0OQ0:pOCIError;const O0CQ0O0OQ0:pOCILobLocator;
var OOCQ0O0OQ0:ub1):sword;cdecl;
function OCILobGetLength_(OQCQ0O0OQ0:pOCISvcCtx;OCCQ0O0OQ0:pOCIError;O00C0O0OQ0:pOCILobLocator;
var OO0C0O0OQ0:ub4):sword;cdecl;
function OCILobCreateTemporary_(OQ0C0O0OQ0:pOCISvcCtx;OC0C0O0OQ0:pOCIError;O0OC0O0OQ0:pOCILobLocator;
OOOC0O0OQ0:ub2;OQOC0O0OQ0:ub1;OCOC0O0OQ0:ub1;O0QC0O0OQ0:tbool;OOQC0O0OQ0:OCIDuration):sword;cdecl;
function OCILobFreeTemporary_(OQQC0O0OQ0:pOCISvcCtx;OCQC0O0OQ0:pOCIError;O0CC0O0OQ0:pOCILobLocator):sword;cdecl;
function OCILobIsTemporary_(OOCC0O0OQ0:pOCIEnv;OQCC0O0OQ0:pOCIError;OCCC0O0OQ0:pOCILobLocator;
var O0000O0OQ0:LongBool):sword;cdecl;
function OCILobLocatorIsInit_(OO000O0OQ0:pOCIEnv;OQ000O0OQ0:pOCIError;const OC000O0OQ0:pOCILobLocator;
var O0O00O0OQ0:tbool):sword;cdecl;
function OCILobRead_(OOO00O0OQ0:pOCISvcCtx;OQO00O0OQ0:pOCIError;OCO00O0OQ0:pOCILobLocator;
var O0Q00O0OQ0:ub4;OOQ00O0OQ0:ub4;OQQ00O0OQ0:IntPtr;OCQ00O0OQ0:ub4;O0C00O0OQ0:IntPtr;
OOC00O0OQ0:IntPtr;OQC00O0OQ0:ub2;OCC00O0OQ0:ub1):sword;cdecl;
function OCILobTrim_(O00O0O0OQ0:pOCISvcCtx;OO0O0O0OQ0:pOCIError;OQ0O0O0OQ0:pOCILobLocator;
OC0O0O0OQ0:ub4):sword;cdecl;
function OCILobWrite_(O0OO0O0OQ0:pOCISvcCtx;OOOO0O0OQ0:pOCIError;OQOO0O0OQ0:pOCILobLocator;
var OCOO0O0OQ0:ub4;O0QO0O0OQ0:ub4;OOQO0O0OQ0:IntPtr;OQQO0O0OQ0:ub4;OCQO0O0OQ0:ub1;
O0CO0O0OQ0:IntPtr;OOCO0O0OQ0:IntPtr;OQCO0O0OQ0:ub2;OCCO0O0OQ0:ub1):sword;cdecl;
function OCILobFileExists_(O00QCO0OQ0:pOCISvcCtx;OO0QCO0OQ0:pOCIError;OQ0QCO0OQ0:pOCILobLocator;
var OC0QCO0OQ0:tbool):sword;cdecl;
function OCILobFileIsOpen_(O0OQCO0OQ0:pOCISvcCtx;OOOQCO0OQ0:pOCIError;OQOQCO0OQ0:pOCILobLocator;
var OCOQCO0OQ0:tbool):sword;cdecl;
function OCILobFileOpen_(O0QQCO0OQ0:pOCISvcCtx;OOQQCO0OQ0:pOCIError;OQQQCO0OQ0:pOCILobLocator;
OCQQCO0OQ0:ub1):sword;cdecl;
function OCILobFileClose_(O0CQCO0OQ0:pOCISvcCtx;OOCQCO0OQ0:pOCIError;OQCQCO0OQ0:pOCILobLocator):sword;cdecl;
function OCILobFileGetName_(OCCQCO0OQ0:pOCIEnv;O00CCO0OQ0:pOCIError;const OO0CCO0OQ0:pOCILobLocator;
OQ0CCO0OQ0:IntPtr;OC0CCO0OQ0:pub2;O0OCCO0OQ0:IntPtr;OOOCCO0OQ0:pub2):sword;cdecl;
function OCILobFileSetName_(OQOCCO0OQ0:pOCIEnv;OCOCCO0OQ0:pOCIError;O0QCCO0OQ0:ppOCILobLocator;
const OOQCCO0OQ0:IntPtr;OQQCCO0OQ0:ub2;const OCQCCO0OQ0:IntPtr;
O0CCCO0OQ0:ub2):sword;cdecl;
function OCINumberAssign_(OQCCCO0OQ0:pOCIError;const OCCCCO0OQ0:pOCINumber;O000CO0OQ0:pOCINumber):sword;cdecl;
function OCINumberCmp_(OQ00CO0OQ0:pOCIError;const OC00CO0OQ0:pOCINumber;const O0O0CO0OQ0:pOCINumber;
var OOO0CO0OQ0:sword):sword;cdecl;
function OCINumberFromInt_(O0Q0CO0OQ0:pOCIError;var OOQ0CO0OQ0:int64;OQQ0CO0OQ0:uword;
OCQ0CO0OQ0:uword;O0C0CO0OQ0:pOCINumber):sword;cdecl;
function OCINumberFromReal_(OQC0CO0OQ0:pOCIError;var OCC0CO0OQ0:double;O00OCO0OQ0:uword;
OO0OCO0OQ0:pOCINumber):sword;cdecl;
function OCINumberFromText_(OC0OCO0OQ0:pOCIError;const O0OOCO0OQ0:IntPtr;OOOOCO0OQ0:ub4;
const OQOOCO0OQ0:IntPtr;OCOOCO0OQ0:ub4;const O0QOCO0OQ0:IntPtr;OOQOCO0OQ0:ub4;
OQQOCO0OQ0:pOCINumber):sword;cdecl;
function OCINumberToInt_(OCCOCO0OQ0:pOCIError;O00QQO0OQ0:pOCINumber;OO0QQO0OQ0:uword;
OQ0QQO0OQ0:uword;var OC0QQO0OQ0:int64):sword;cdecl;
function OCINumberToReal_(OOOQQO0OQ0:pOCIError;const OQOQQO0OQ0:pOCINumber;OCOQQO0OQ0:uword;
var O0QQQO0OQ0:double):sword;cdecl;
function OCINumberToText_(OQQQQO0OQ0:pOCIError;OCQQQO0OQ0:pOCINumber;const O0CQQO0OQ0:IntPtr;
OOCQQO0OQ0:ub4;const OQCQQO0OQ0:IntPtr;OCCQQO0OQ0:ub4;var O00CQO0OQ0:ub4;
OO0CQO0OQ0:IntPtr):sword;cdecl;
function OCIDateTimeAssign_(OQOCQO0OQ0:IntPtr;OCOCQO0OQ0:pOCIError;O0QCQO0OQ0:pOCIDateTime;
OOQCQO0OQ0:pOCIDateTime):sword;cdecl;
function OCIDateTimeCheck_(O0CCQO0OQ0:IntPtr;OOCCQO0OQ0:pOCIError;OQCCQO0OQ0:pOCIDateTime;
var OCCCQO0OQ0:ub4):sword;cdecl;
function OCIDateTimeCompare_(OO00QO0OQ0:IntPtr;OQ00QO0OQ0:pOCIError;const OC00QO0OQ0:pOCIDateTime;
const O0O0QO0OQ0:pOCIDateTime;var OOO0QO0OQ0:sword):sword;cdecl;
function OCIDateTimeConstruct_(O0Q0QO0OQ0:IntPtr;OOQ0QO0OQ0:pOCIError;OQQ0QO0OQ0:pOCIDateTime;
OCQ0QO0OQ0:sb2;O0C0QO0OQ0,OOC0QO0OQ0,OQC0QO0OQ0,OCC0QO0OQ0,O00OQO0OQ0:ub1;OO0OQO0OQ0:ub4;OQ0OQO0OQ0:IntPtr;
OC0OQO0OQ0:integer):sword;cdecl;
function OCIDateTimeFromText_(OCOOQO0OQ0:IntPtr;O0QOQO0OQ0:pOCIError;OOQOQO0OQ0:IntPtr;
OQQOQO0OQ0:integer;OCQOQO0OQ0:IntPtr;O0COQO0OQ0:ub1;OOCOQO0OQ0:IntPtr;
OQCOQO0OQ0:integer;OCCOQO0OQ0:pOCIDateTime):sword;cdecl;
function OCIDateTimeToText_(O0OQO00OQ0:IntPtr;OOOQO00OQ0:pOCIError;OQOQO00OQ0:pOCIDateTime;OCOQO00OQ0:IntPtr;
O0QQO00OQ0,OOQQO00OQ0:ub1;OQQQO00OQ0:IntPtr;OCQQO00OQ0:integer;var O0CQO00OQ0:ub4;
OOCQO00OQ0:IntPtr):sword;cdecl;
function OCIDateTimeGetDate_(OQ0CO00OQ0:IntPtr;OC0CO00OQ0:pOCIError;O0OCO00OQ0:pOCIDateTime;
var OOOCO00OQ0:sb2;var OQOCO00OQ0:ub1;var OCOCO00OQ0:ub1):sword;cdecl;
function OCIDateTimeGetTime_(OOQCO00OQ0:IntPtr;OQQCO00OQ0:pOCIError;OCQCO00OQ0:pOCIDateTime;
var O0CCO00OQ0:ub1;var OOCCO00OQ0:ub1;var OQCCO00OQ0:ub1;var OCCCO00OQ0:ub4):sword;cdecl;
function OCIDateTimeGetTimeZoneOffset_(OO00O00OQ0:IntPtr;OQ00O00OQ0:pOCIError;OC00O00OQ0:pOCIDateTime;
var O0O0O00OQ0:sb1;var OOO0O00OQ0:sb1):sword;cdecl;
function OCIDateTimeGetTimeZoneName_(OCO0O00OQ0:IntPtr;O0Q0O00OQ0:pOCIError;OOQ0O00OQ0:pOCIDateTime;
OQQ0O00OQ0:pub1;var OCQ0O00OQ0:ub4):sword;cdecl;
function OCIIntervalAssign_(OQC0O00OQ0:IntPtr;OCC0O00OQ0:pOCIError;O00OO00OQ0:pOCIInterval;
OO0OO00OQ0:pOCIInterval):sword;cdecl;
function OCIIntervalCheck_(O0OOO00OQ0:IntPtr;OOOOO00OQ0:pOCIError;OQOOO00OQ0:pOCIInterval;
var OCOOO00OQ0:ub4):sword;cdecl;
function OCIIntervalCompare_(OOQOO00OQ0:IntPtr;OQQOO00OQ0:pOCIError;OCQOO00OQ0:pOCIInterval;
O0COO00OQ0:pOCIInterval;var OOCOO00OQ0:sword):sword;cdecl;
function OCIIntervalFromText_(O00Q000OQ0:IntPtr;OO0Q000OQ0:pOCIError;OQ0Q000OQ0:IntPtr;
OC0Q000OQ0:integer;O0OQ000OQ0:pOCIInterval):sword;cdecl;
function OCIIntervalToText_(O0QQ000OQ0:IntPtr;OOQQ000OQ0:pOCIError;OQQQ000OQ0:pOCIInterval;
OCQQ000OQ0,O0CQ000OQ0:ub1;OOCQ000OQ0:IntPtr;OQCQ000OQ0:NativeUInt;var OCCQ000OQ0:NativeUInt):sword;cdecl;
function OCIIntervalSetYearMonth_(OQ0C000OQ0:IntPtr;OC0C000OQ0:pOCIError;O0OC000OQ0,OOOC000OQ0:sb4;
OQOC000OQ0:pOCIInterval):sword;cdecl;
function OCIIntervalGetYearMonth_(O0QC000OQ0:IntPtr;OOQC000OQ0:pOCIError;var OQQC000OQ0:sb4;var OCQC000OQ0:sb4;
O0CC000OQ0:pOCIInterval):sword;cdecl;
function OCIIntervalSetDaySecond_(OQCC000OQ0:IntPtr;OCCC000OQ0:pOCIError;O000000OQ0,OO00000OQ0,
OQ00000OQ0,OC00000OQ0,O0O0000OQ0:sb4;OOO0000OQ0:pOCIInterval):sword;cdecl;
function OCIIntervalGetDaySecond_(OCO0000OQ0:IntPtr;O0Q0000OQ0:pOCIError;var OOQ0000OQ0:sb4;var OQQ0000OQ0:sb4;
var OCQ0000OQ0:sb4;var O0C0000OQ0:sb4;var OOC0000OQ0:sb4;OQC0000OQ0:pOCIInterval):sword;cdecl;
function OCIIntervalFromNumber_(O00O000OQ0:IntPtr;OO0O000OQ0:pOCIError;OQ0O000OQ0:pOCIInterval;
OC0O000OQ0:pOCINumber):sword;cdecl;
function OCIRowIdToChar_(OOOO000OQ0:IntPtr;OQOO000OQ0:IntPtr;var OCOO000OQ0:ub2;
O0QO000OQ0:pOCIError):sword;cdecl;
function OCIStringAllocSize_(OOQO000OQ0:pOCIEnv;OQQO000OQ0:pOCIError;const OCQO000OQ0:pOCIString;O0CO000OQ0:pub4):sword;cdecl;
function OCIStringAssign_(OQCO000OQ0:pOCIEnv;OCCO000OQ0:pOCIError;const O00QC00OQ0:pOCIString;
OO0QC00OQ0:ppOCIString):sword;cdecl;
function OCIStringAssignText_(O0OQC00OQ0:pOCIEnv;OOOQC00OQ0:pOCIError;const OQOQC00OQ0:IntPtr;
OCOQC00OQ0:ub4;O0QQC00OQ0:ppOCIString):sword;cdecl;
function OCIStringPtr_(OCQQC00OQ0:pOCIEnv;const O0CQC00OQ0:pOCIString):IntPtr;cdecl;
function OCIStringResize_(OQCQC00OQ0:pOCIEnv;OCCQC00OQ0:pOCIError;O00CC00OQ0:ub4;OO0CC00OQ0:ppOCIString):sword;cdecl;
function OCIStringSize_(OC0CC00OQ0:pOCIEnv;const O0OCC00OQ0:pOCIString):ub4;cdecl;
function OCIDescribeAny_(OQOCC00OQ0:pOCISvcCtx;OCOCC00OQ0:pOCIError;O0QCC00OQ0:IntPtr;
OOQCC00OQ0:ub4;OQQCC00OQ0:ub1;OCQCC00OQ0:ub1;O0CCC00OQ0:ub1;
OOCCC00OQ0:pOCIDescribe):sword;cdecl;
function OCITypeByName_(OO00C00OQ0:pOCIEnv;OQ00C00OQ0:pOCIError;const OC00C00OQ0:pOCISvcCtx;
const O0O0C00OQ0:IntPtr;OOO0C00OQ0:ub4;const OQO0C00OQ0:IntPtr;
OCO0C00OQ0:ub4;O0Q0C00OQ0:IntPtr;OOQ0C00OQ0:ub4;OQQ0C00OQ0:OCIDuration;
OCQ0C00OQ0:OCITypeGetOpt;var O0C0C00OQ0:pOCIType):sword;cdecl;
function OCIObjectNew_(OO0OC00OQ0:pOCIEnv;OQ0OC00OQ0:pOCIError;const OC0OC00OQ0:pOCISvcCtx;
O0OOC00OQ0:OCITypeCode;OOOOC00OQ0:pOCIType;OQOOC00OQ0:IntPtr;
OCOOC00OQ0:OCIDuration;O0QOC00OQ0:tbool;var OOQOC00OQ0:IntPtr):sword;cdecl;
function OCIObjectCopy_(OOCOC00OQ0:pOCIEnv;OQCOC00OQ0:pOCIError;const OCCOC00OQ0:pOCISvcCtx;
O00QQ00OQ0:IntPtr;OO0QQ00OQ0:IntPtr;OQ0QQ00OQ0:IntPtr;
OC0QQ00OQ0:IntPtr;O0OQQ00OQ0:pOCIType;OOOQQ00OQ0:OCIDuration;
OQOQQ00OQ0:ub1):sword;cdecl;
function OCIObjectFree_(OOQQQ00OQ0:pOCIEnv;OQQQQ00OQ0:pOCIError;OCQQQ00OQ0:IntPtr;
O0CQQ00OQ0:ub2):sword;cdecl;
function OCIObjectPtr_(OQCQQ00OQ0:pOCIEnv;OCCQQ00OQ0:pOCIError;O00CQ00OQ0:IntPtr):IntPtr;cdecl;
function OCIObjectGetInd_(OC0CQ00OQ0:pOCIEnv;O0OCQ00OQ0:pOCIError;OOOCQ00OQ0:IntPtr;
OQOCQ00OQ0:IntPtr):sword;cdecl;
function OCIObjectSetAttr_(O0QCQ00OQ0:pOCIEnv;OOQCQ00OQ0:pOCIError;OQQCQ00OQ0:IntPtr;
OCQCQ00OQ0:IntPtr;O0CCQ00OQ0:pOCIType;OOCCQ00OQ0:IntPtr;
const OQCCQ00OQ0:pub4;const OCCCQ00OQ0:ub4;const O000Q00OQ0:pub4;
const OO00Q00OQ0:ub4;const OQ00Q00OQ0:OCIInd;
const OC00Q00OQ0:IntPtr;const O0O0Q00OQ0:IntPtr):sword;cdecl;
function OCIObjectGetAttr_(OOC0Q00OQ0:pOCIEnv;OQC0Q00OQ0:pOCIError;OCC0Q00OQ0:IntPtr;
O00OQ00OQ0:IntPtr;OO0OQ00OQ0:pOCIType;OQ0OQ00OQ0:IntPtr;
const OC0OQ00OQ0:pub4;const O0OOQ00OQ0:ub4;const OOOOQ00OQ0:pub4;
const OQOOQ00OQ0:ub4;OCOOQ00OQ0:pOCIInd;
O0QOQ00OQ0:IntPtr;OOQOQ00OQ0:IntPtr;OQQOQ00OQ0:ppOCIType):sword;cdecl;
function OCIDefineObject_(OC0QOCC0Q0:pOCIDefine;O0OQOCC0Q0:pOCIError;const OOOQOCC0Q0:pOCIType;
OQOQOCC0Q0:IntPtr;OCOQOCC0Q0:pub4;O0QQOCC0Q0:IntPtr;OOQQOCC0Q0:pub4):sword;cdecl;
function OCIBindObject_(OQQQOCC0Q0:pOCIBind;OCQQOCC0Q0:pOCIError;const O0CQOCC0Q0:pOCIType;
OOCQOCC0Q0:IntPtr;OQCQOCC0Q0:pub4;OCCQOCC0Q0:IntPtr;O00COCC0Q0:pub4):sword;cdecl;
function OCIRefIsNull_(OO0COCC0Q0:pOCIEnv;const OQ0COCC0Q0:pOCIRef):tbool;cdecl;
function OCIObjectPin2_(OOOCOCC0Q0:pOCIEnv;const OQOCOCC0Q0:pOCISvcCtx;OCOCOCC0Q0:pOCIError;O0QCOCC0Q0:pOCIRef;
OOQCOCC0Q0:pOCIComplexObject;OQQCOCC0Q0:OCIPinOpt;OCQCOCC0Q0:OCIDuration;
O0CCOCC0Q0:OCILockOpt;OOCCOCC0Q0:IntPtr):sword;cdecl;
function OCITableSize_(OO00OCC0Q0:pOCIEnv;OQ00OCC0Q0:pOCIError;const OC00OCC0Q0:pOCITable;
var O0O0OCC0Q0:sb4):sword;cdecl;
function OCITableNext_(OQO0OCC0Q0:pOCIEnv;OCO0OCC0Q0:pOCIError;O0Q0OCC0Q0:sb4;const OOQ0OCC0Q0:pOCITable;
var OQQ0OCC0Q0:sb4;var OCQ0OCC0Q0:tbool):sword;cdecl;
function OCITableDelete_(OOC0OCC0Q0:pOCIEnv;OQC0OCC0Q0:pOCIError;OCC0OCC0Q0:sb4;O00OOCC0Q0:pOCITable):sword;cdecl;
function OCICollSize_(OQ0OOCC0Q0:pOCIEnv;OC0OOCC0Q0:pOCIError;const O0OOOCC0Q0:pOCIColl;
var OOOOOCC0Q0:sb4):sword;cdecl;
function OCICollTrim_(OCOOOCC0Q0:pOCIEnv;O0QOOCC0Q0:pOCIError;OOQOOCC0Q0:sb4;OQQOOCC0Q0:pOCIColl):sword;cdecl;
function OCICollAppend_(OOCOOCC0Q0:pOCIEnv;OQCOOCC0Q0:pOCIError;const OCCOOCC0Q0:IntPtr;
const O00Q0CC0Q0:IntPtr;OO0Q0CC0Q0:pOCIColl):sword;cdecl;
function OCICollAssign_(OCOQ0CC0Q0:pOCIEnv;O0QQ0CC0Q0:pOCIError;const OOQQ0CC0Q0:pOCIColl;
OQQQ0CC0Q0:pOCIColl):sword;cdecl;
function OCICollAssignElem_(OOCQ0CC0Q0:pOCIEnv;OQCQ0CC0Q0:pOCIError;OCCQ0CC0Q0:sb4;
const O00C0CC0Q0:IntPtr;const OO0C0CC0Q0:IntPtr;OQ0C0CC0Q0:pOCIColl):sword;cdecl;
function OCICollGetElem_(O0QC0CC0Q0:pOCIEnv;OOQC0CC0Q0:pOCIError;const OQQC0CC0Q0:pOCIColl;
OCQC0CC0Q0:sb4;var O0CC0CC0Q0:tbool;var OOCC0CC0Q0:IntPtr;var OQCC0CC0Q0:IntPtr):sword;cdecl;
function OCIXMLTypeNew_(OQ000CC0Q0:pOCISvcCtx;OC000CC0Q0:pOCIError;O0O00CC0Q0:OCIDuration;
OOO00CC0Q0:PAnsiChar;OQO00CC0Q0:ub4;OCO00CC0Q0:PAnsiChar;
O0Q00CC0Q0:ub4;var OOQ00CC0Q0:pOCIXMLType):sword;cdecl;
function OCIXMLTypeCreateFromSrc_(OOC00CC0Q0:pOCISvcCtx;OQC00CC0Q0:pOCIError;OCC00CC0Q0:OCIDuration;
O00O0CC0Q0:ub1;OO0O0CC0Q0:IntPtr;OQ0O0CC0Q0:sb4;var OC0O0CC0Q0:pOCIXMLType):sword;cdecl;
function OCIPStreamFromXMLType_(OQQO0CC0Q0:pOCIError;OCQO0CC0Q0:IntPtr;
O0CO0CC0Q0:IntPtr;OOCO0CC0Q0:integer):sword;cdecl;
function OCIPStreamRead_(OC0QCCC0Q0:pOCIError;O0OQCCC0Q0:IntPtr;
OOOQCCC0Q0:IntPtr;var OQOQCCC0Q0:int64;OCOQCCC0Q0:integer):sword;cdecl;
function OCIPStreamClose_(O0CQCCC0Q0:pOCIError;OOCQCCC0Q0:IntPtr):sword;cdecl;
function OCIAnyDataAccess_(OCCQCCC0Q0:pOCISvcCtx;O00CCCC0Q0:pOCIError;OO0CCCC0Q0:pOCIAnyData;
OQ0CCCC0Q0:OCITypeCode;OC0CCCC0Q0:pOCIType;O0OCCCC0Q0:IntPtr;
out OOOCCCC0Q0:IntPtr;out OQOCCCC0Q0:ub4):sword;cdecl;
function OCIAnyDataConvert_(OOQCCCC0Q0:pOCISvcCtx;OQQCCCC0Q0:pOCIError;OCQCCCC0Q0:OCITypeCode;
O0CCCCC0Q0:pOCIType;OOCCCCC0Q0:OCIDuration;OQCCCCC0Q0:IntPtr;OCCCCCC0Q0:IntPtr;O000CCC0Q0:ub4;
OO00CCC0Q0:IntPtr):sword;cdecl;
function OCIAnyDataGetType_(OQO0CCC0Q0:pOCISvcCtx;OCO0CCC0Q0:pOCIError;O0Q0CCC0Q0:pOCIAnyData;
out OOQ0CCC0Q0:OCITypeCode;out OQQ0CCC0Q0:pOCIType):sword;cdecl;
implementation
uses
{$IFNDEF UNIDACPRO}
OraNetClasses,OraNetObjects;
{$ELSE}
OraNetClassesUni,OraNetObjectsUni;
{$ENDIF}
function OCIEnvCreate_(var OQOCQQ0OQ0:pOCIEnv;OCOCQQ0OQ0:ub4;const O0QCQQ0OQ0:IntPtr;
const OOQCQQ0OQ0:IntPtr;const OQQCQQ0OQ0:IntPtr;const OCQCQQ0OQ0:IntPtr;
O0CCQQ0OQ0:NativeUInt;OOCCQQ0OQ0:IntPtr):sword;cdecl;
begin
OQOCQQ0OQ0:=O0CQQ0COQ0.Create(OCOCQQ0OQ0).OQQOQOCOQ0;
Result:=OCI_SUCCESS;
end;
function OCIErrorGet_(OQCCQQ0OQ0:pOCIHandle;OCCCQQ0OQ0:ub4;O000QQ0OQ0:IntPtr;var OO00QQ0OQ0:sb4;
OQ00QQ0OQ0:IntPtr;OC00QQ0OQ0:ub4;O0O0QQ0OQ0:ub4):sword;cdecl;
var
OOO0QQ0OQ0:ub4;
OQO0QQ0OQ0:OQ0CQ0COQ0;
OCO0QQ0OQ0:O0CQQ0COQ0;
O0Q0QQ0OQ0:TBytes;
begin
if O0O0QQ0OQ0=OCI_HTYPE_ERROR then begin
OQO0QQ0OQ0:=OQ0CQ0COQ0(GetGCHandleTarget(OQCCQQ0OQ0));
OCO0QQ0OQ0:=O0CQQ0COQ0(OQO0QQ0OQ0.OCQOQOCOQ0);
OO00QQ0OQ0:=OQO0QQ0OQ0.OQOCQ0COQ0;
if OO00QQ0OQ0<>0 then begin
OOO0QQ0OQ0:=Length(OQO0QQ0OQ0.OCOCQ0COQ0);
if OCO0QQ0OQ0.O00CQ0COQ0 then begin
OOO0QQ0OQ0:=OOO0QQ0OQ0*2;
if OC00QQ0OQ0>OOO0QQ0OQ0+2 then
OC00QQ0OQ0:=OOO0QQ0OQ0+2;
end
else begin
if OC00QQ0OQ0>OOO0QQ0OQ0+1 then
OC00QQ0OQ0:=OOO0QQ0OQ0+1;
end;
SetLength(O0Q0QQ0OQ0,0);
if O0CQQ0COQ0(OQO0QQ0OQ0.OCQOQOCOQ0).O00CQ0COQ0 then begin
O0Q0QQ0OQ0:=Encoding.Unicode.GetBytes(OQO0QQ0OQ0.OCOCQ0COQ0);
Marshal.Copy(O0Q0QQ0OQ0,0,OQ00QQ0OQ0,OC00QQ0OQ0-2);
end
else begin
O0Q0QQ0OQ0:=Encoding.Default.GetBytes(OQO0QQ0OQ0.OCOCQ0COQ0);
Marshal.Copy(O0Q0QQ0OQ0,0,OQ00QQ0OQ0,OC00QQ0OQ0-1);
end;
Marshal.WriteByte(OQ00QQ0OQ0,OC00QQ0OQ0-1,0);
if OCO0QQ0OQ0.O00CQ0COQ0 then
Marshal.WriteByte(OQ00QQ0OQ0,OC00QQ0OQ0-2,0);
Result:=OCI_SUCCESS;
end
else
Result:=OCI_NO_DATA;
end
else
Result:=OCI_INVALID_HANDLE;
end;
function OCIHandleAlloc_(OOQ0QQ0OQ0:IntPtr;var OQQ0QQ0OQ0:pOCIHandle;OCQ0QQ0OQ0:ub4;
O0C0QQ0OQ0:NativeUInt;OOC0QQ0OQ0:IntPtr):sword;cdecl;
begin
Result:=OCI_SUCCESS;
case OCQ0QQ0OQ0 of
OCI_HTYPE_ERROR:
OQQ0QQ0OQ0:=OQ0CQ0COQ0.Create(O0CCQOCOQ0(GetGCHandleTarget(OOQ0QQ0OQ0))).OQQOQOCOQ0;
OCI_HTYPE_SVCCTX:
OQQ0QQ0OQ0:=OOO0CQQOQ0.Create(O0CCQOCOQ0(GetGCHandleTarget(OOQ0QQ0OQ0))).OQQOQOCOQ0;
OCI_HTYPE_STMT:
OQQ0QQ0OQ0:=OOCCQ0COQ0.Create(O0CCQOCOQ0(GetGCHandleTarget(OOQ0QQ0OQ0))).OQQOQOCOQ0;
OCI_HTYPE_DESCRIBE:
OQQ0QQ0OQ0:=OCQOO0COQ0.Create(O0CCQOCOQ0(GetGCHandleTarget(OOQ0QQ0OQ0))).OQQOQOCOQ0;
OCI_HTYPE_SERVER:
OQQ0QQ0OQ0:=O0QCQ0COQ0.Create(O0CCQOCOQ0(GetGCHandleTarget(OOQ0QQ0OQ0))).OQQOQOCOQ0;
OCI_HTYPE_SESSION:
OQQ0QQ0OQ0:=OO00CQQOQ0.Create(O0CCQOCOQ0(GetGCHandleTarget(OOQ0QQ0OQ0))).OQQOQOCOQ0;
else
Result:=OCI_INVALID_HANDLE;
end;
end;
function OCIHandleFree_(OQC0QQ0OQ0:pOCIHandle;OCC0QQ0OQ0:ub4):sword;cdecl;
var
O00OQQ0OQ0:O0CCQOCOQ0;
begin
Result:=OCI_SUCCESS;
O00OQQ0OQ0:=O0CCQOCOQ0(GetGCHandleTarget(OQC0QQ0OQ0));
if O00OQQ0OQ0<>nil then
O00OQQ0OQ0.OCQ0QOCOQ0;
end;
function OCIDescriptorAlloc_(OQCQQQ0OQ0:IntPtr;var OCCQQQ0OQ0:pOCIDescriptor;O00CQQ0OQ0:ub4;
OO0CQQ0OQ0:NativeUInt;OQ0CQQ0OQ0:IntPtr):sword;cdecl;
begin
Result:=OCI_SUCCESS;
case O00CQQ0OQ0 of
OCI_DTYPE_ROWID:
OCCQQQ0OQ0:=OOOCO0QOQ0.Create(O0CCQOCOQ0(GetGCHandleTarget(OQCQQQ0OQ0))).OQQOQOCOQ0;
OCI_DTYPE_LOB:
OCCQQQ0OQ0:=OOCCQ0QOQ0.Create(O0CCQOCOQ0(GetGCHandleTarget(OQCQQQ0OQ0))).OQQOQOCOQ0;
OCI_DTYPE_FILE:
OCCQQQ0OQ0:=OOCCQ0QOQ0.Create(O0CCQOCOQ0(GetGCHandleTarget(OQCQQQ0OQ0)),SQLT_BFILEE).OQQOQOCOQ0;
OCI_DTYPE_TIMESTAMP,
OCI_DTYPE_TIMESTAMP_TZ,
OCI_DTYPE_TIMESTAMP_LTZ:
OCCQQQ0OQ0:=O00O0QOOQ0.Create(O0CCQOCOQ0(GetGCHandleTarget(OQCQQQ0OQ0)),O00CQQ0OQ0).OQQOQOCOQ0;
OCI_DTYPE_INTERVAL_YM:
OCCQQQ0OQ0:=O0OO0QOOQ0.Create(O0CCQOCOQ0(GetGCHandleTarget(OQCQQQ0OQ0)),O00CQQ0OQ0).OQQOQOCOQ0;
OCI_DTYPE_INTERVAL_DS:
OCCQQQ0OQ0:=O0OO0QOOQ0.Create(O0CCQOCOQ0(GetGCHandleTarget(OQCQQQ0OQ0)),O00CQQ0OQ0).OQQOQOCOQ0;
OCI_DTYPE_XML_STREAM:
OCCQQQ0OQ0:=OCOCOC0OQ0.Create(O0CCQOCOQ0(GetGCHandleTarget(OQCQQQ0OQ0))).OQQOQOCOQ0;
else
Result:=OCI_INVALID_HANDLE;
end;
end;
function OCIDescriptorFree_(OC0CQQ0OQ0:pOCIDescriptor;O0OCQQ0OQ0:ub4):sword;cdecl;
var
OOOCQQ0OQ0:O0CCQOCOQ0;
begin
Result:=OCI_SUCCESS;
if O0OCQQ0OQ0=OCI_DTYPE_PARAM then
Exit;
OOOCQQ0OQ0:=O0CCQOCOQ0(GetGCHandleTarget(OC0CQQ0OQ0));
if OOOCQQ0OQ0<>nil then
OOOCQQ0OQ0.OCQ0QOCOQ0;
end;
function OCIAttrGet_(O0QO0Q0OQ0:pOCIHandle;OOQO0Q0OQ0:ub4;OQQO0Q0OQ0:IntPtr;
OCQO0Q0OQ0:pub4;O0CO0Q0OQ0:ub4;OOCO0Q0OQ0:pOCIError):sword;cdecl;
begin
Result:=O0CCQOCOQ0(GetGCHandleTarget(O0QO0Q0OQ0)).O0C0QOCOQ0(OQQO0Q0OQ0,OCQO0Q0OQ0,O0CO0Q0OQ0,OOCO0Q0OQ0);
end;
function OCIAttrGet2_(OQCO0Q0OQ0:pOCIHandle;OCCO0Q0OQ0:ub4;var O00QCQ0OQ0:Integer;
OO0QCQ0OQ0:pub4;OQ0QCQ0OQ0:ub4;OC0QCQ0OQ0:pOCIError):sword;cdecl;
begin
O00QCQ0OQ0:=0;
Result:=O0CCQOCOQ0(GetGCHandleTarget(OQCO0Q0OQ0)).O0C0QOCOQ0(@O00QCQ0OQ0,OO0QCQ0OQ0,OQ0QCQ0OQ0,OC0QCQ0OQ0);
end;
function OCIAttrSet_(O0OQCQ0OQ0:pOCIHandle;OOOQCQ0OQ0:ub4;OQOQCQ0OQ0:IntPtr;
OCOQCQ0OQ0:ub4;O0QQCQ0OQ0:ub4;OOQQCQ0OQ0:pOCIError):sword;cdecl;
begin
Result:=O0CCQOCOQ0(GetGCHandleTarget(O0OQCQ0OQ0)).OO0OQOCOQ0(OQOQCQ0OQ0,OCOQCQ0OQ0,O0QQCQ0OQ0,OOQQCQ0OQ0);
end;
function OCIAttrSet2_(OQQQCQ0OQ0:pOCIHandle;OCQQCQ0OQ0:ub4;var O0CQCQ0OQ0:Integer;
OOCQCQ0OQ0:ub4;OQCQCQ0OQ0:ub4;OCCQCQ0OQ0:pOCIError):sword;cdecl;
begin
Result:=O0CCQOCOQ0(GetGCHandleTarget(OQQQCQ0OQ0)).OO0OQOCOQ0(@O0CQCQ0OQ0,OOCQCQ0OQ0,OQCQCQ0OQ0,OCCQCQ0OQ0);
end;
function OCIParamGet_(OO0OQQ0OQ0:pOCIHandle;OQ0OQQ0OQ0:ub4;OC0OQQ0OQ0:pOCIError;
var O0OOQQ0OQ0:pOCIParam;OOOOQQ0OQ0:ub4):sword;cdecl;
begin
Result:=O0CCQOCOQ0(GetGCHandleTarget(OO0OQQ0OQ0)).OQOOQOCOQ0(OC0OQQ0OQ0,O0OOQQ0OQ0,OOOOQQ0OQ0);
end;
function OCIServerAttach_(OCCOQQ0OQ0:pOCIServer;O00QOO0OQ0:pOCIError;OO0QOO0OQ0:IntPtr;
OQ0QOO0OQ0:sb4;OC0QOO0OQ0:ub4):sword;cdecl;
var
O0OQOO0OQ0:O0QCQ0COQ0;
begin
O0OQOO0OQ0:=O0QCQ0COQ0(GetGCHandleTarget(OCCOQQ0OQ0));
O0OQOO0OQ0.OCQCQ0COQ0:=O0CQCQOOQ0(O0OQOO0OQ0.O0CCQ0COQ0.O00CQ0COQ0,OO0QOO0OQ0,OQ0QOO0OQ0);
Result:=OCI_SUCCESS;
end;
function OCIServerDetach_(OOOQOO0OQ0:pOCIServer;OQOQOO0OQ0:pOCIError;OCOQOO0OQ0:ub4):sword;cdecl;
begin
Result:=OCI_SUCCESS;
end;
function OCISessionBegin_(OOCQOO0OQ0:pOCISvcCtx;OQCQOO0OQ0:pOCIError;OCCQOO0OQ0:pOCISession;
O00COO0OQ0:ub4;OO0COO0OQ0:ub4):sword;cdecl;
begin
OOO0CQQOQ0(GetGCHandleTarget(OOCQOO0OQ0)).OQCOQOQOQ0:=OO00CQQOQ0(GetGCHandleTarget(OCCQOO0OQ0));
Result:=OOO0CQQOQ0(GetGCHandleTarget(OOCQOO0OQ0)).OOOQCOQOQ0(OQCQOO0OQ0,O00COO0OQ0,OO0COO0OQ0);
end;
function OCISessionEnd_(OQ0COO0OQ0:pOCISvcCtx;OC0COO0OQ0:pOCIError;O0OCOO0OQ0:pOCISession;
OOOCOO0OQ0:ub4):sword;cdecl;
begin
Result:=OOO0CQQOQ0(GetGCHandleTarget(OQ0COO0OQ0)).OOQQCOQOQ0(OC0COO0OQ0);
end;
function OCIServerVersion_(O0QQOO0OQ0:IntPtr;OOQQOO0OQ0:pOCIError;OQQQOO0OQ0:IntPtr;OCQQOO0OQ0:ub4;
O0CQOO0OQ0:ub1):sword;cdecl;
begin
if O0CQOO0OQ0=OCI_HTYPE_SVCCTX then
Result:=OOO0CQQOQ0(GetGCHandleTarget(O0QQOO0OQ0)).OCQQQOQOQ0(OOQQOO0OQ0,OQQQOO0OQ0,OCQQOO0OQ0,O0CQOO0OQ0)
else
Result:=OCI_SUCCESS;
end;
function OCIBreak_(OCOOCQ0OQ0:pOCIHandle;O0QOCQ0OQ0:pOCIError):sword;cdecl;
begin
Result:=OOO0CQQOQ0(GetGCHandleTarget(OCOOCQ0OQ0)).OOQQQOQOQ0(O0QOCQ0OQ0);
end;
function OCIPasswordChange_(OQOOQQ0OQ0:pOCISvcCtx;OCOOQQ0OQ0:pOCIError;const O0QOQQ0OQ0:IntPtr;
OOQOQQ0OQ0:ub4;const OQQOQQ0OQ0:IntPtr;OCQOQQ0OQ0:ub4;
const O0COQQ0OQ0:IntPtr;OOCOQQ0OQ0:sb4;OQCOQQ0OQ0:ub4):sword;cdecl;
begin
Result:=OOO0CQQOQ0(GetGCHandleTarget(OQOOQQ0OQ0)).OCQQCOQOQ0(OCOOQQ0OQ0,O0QOQQ0OQ0,OOQOQQ0OQ0,OQQOQQ0OQ0,OCQOQQ0OQ0,O0COQQ0OQ0,OOCOQQ0OQ0,OQCOQQ0OQ0);
end;
function OCITransCommit_(O0OQ0O0OQ0:pOCISvcCtx;OOOQ0O0OQ0:pOCIError;OQOQ0O0OQ0:ub4):sword;cdecl;
begin
Result:=OOO0CQQOQ0(GetGCHandleTarget(O0OQ0O0OQ0)).OOOQQOQOQ0(OOOQ0O0OQ0);
end;
function OCITransRollback_(OCOQ0O0OQ0:pOCISvcCtx;O0QQ0O0OQ0:pOCIError;OOQQ0O0OQ0:ub4):sword;cdecl;
begin
Result:=OOO0CQQOQ0(GetGCHandleTarget(OCOQ0O0OQ0)).OCOQQOQOQ0(O0QQ0O0OQ0);
end;
function OCIStmtExecute_(OQOCOO0OQ0:pOCISvcCtx;OCOCOO0OQ0:pOCIStmt;O0QCOO0OQ0:pOCIError;
OOQCOO0OQ0:ub4;OQQCOO0OQ0:ub4;OCQCOO0OQ0:pOCISnapshot;O0CCOO0OQ0:pOCISnapshot;
OOCCOO0OQ0:ub4):sword;cdecl;
var
OQCCOO0OQ0:OOCCQ0COQ0;
begin
OQCCOO0OQ0:=OOCCQ0COQ0(GetGCHandleTarget(OCOCOO0OQ0));
OQCCOO0OQ0.OQQCCQQOQ0:=OOO0CQQOQ0(GetGCHandleTarget(OQOCOO0OQ0));
if OOCCOO0OQ0 and OCI_DESCRIBE_ONLY=0 then
Result:=OQCCOO0OQ0.OQQQCQQOQ0(O0QCOO0OQ0,OOQCOO0OQ0,OQQCOO0OQ0,OOCCOO0OQ0)
else
Result:=OQCCOO0OQ0.OOOQ0QQOQ0(O0QCOO0OQ0);
end;
function OCIStmtFetch_(OCCCOO0OQ0:pOCIStmt;O000OO0OQ0:pOCIError;OO00OO0OQ0:ub4;OQ00OO0OQ0:ub2;
OC00OO0OQ0:ub4):sword;cdecl;
var
O0O0OO0OQ0:OOCCQ0COQ0;
begin
O0O0OO0OQ0:=OOCCQ0COQ0(GetGCHandleTarget(OCCCOO0OQ0));
Result:=O0O0OO0OQ0.OC0QCQQOQ0(O000OO0OQ0,OO00OO0OQ0);
end;
function OCIStmtPrepare_(OOO0OO0OQ0:pOCIStmt;OQO0OO0OQ0:pOCIError;OCO0OO0OQ0:IntPtr;O0Q0OO0OQ0:ub4;
OOQ0OO0OQ0:ub4;OQQ0OO0OQ0:ub4):sword;cdecl;
var
OCQ0OO0OQ0:OOCCQ0COQ0;
begin
OCQ0OO0OQ0:=OOCCQ0COQ0(GetGCHandleTarget(OOO0OO0OQ0));
OCQ0OO0OQ0.O0CCCQQOQ0:=TrimRight(O0CQCQOOQ0(OCQ0OO0OQ0.OOQCCQQOQ0.O00CQ0COQ0,OCO0OO0OQ0,O0Q0OO0OQ0));
Result:=OCQ0OO0OQ0.OQO0OQQOQ0(OQO0OO0OQ0);
end;
function OCIStmtPrepare2_(O0C0OO0OQ0:pOCISvcCtx;var OOC0OO0OQ0:pOCIStmt;OQC0OO0OQ0:pOCIError;
OCC0OO0OQ0:IntPtr;O00OOO0OQ0:ub4;OO0OOO0OQ0:IntPtr;OQ0OOO0OQ0:ub4;OC0OOO0OQ0:ub4;
O0OOOO0OQ0:ub4):sword;cdecl;
var
OOOOOO0OQ0:OOCCQ0COQ0;
begin
OOOOOO0OQ0:=OOCCQ0COQ0(GetGCHandleTarget(OOC0OO0OQ0));
OOOOOO0OQ0.OQQCCQQOQ0:=OOO0CQQOQ0(GetGCHandleTarget(O0C0OO0OQ0));
OOOOOO0OQ0.O0CCCQQOQ0:=TrimRight(O0CQCQOOQ0(OOOOOO0OQ0.OOQCCQQOQ0.O00CQ0COQ0,OCC0OO0OQ0,O00OOO0OQ0));
Result:=OOOOOO0OQ0.OQO0OQQOQ0(OQC0OO0OQ0);
end;
function OCIStmtPrepare3_(OQOOOO0OQ0:pOCISvcCtx;OCOOOO0OQ0:pOCIStmt;O0QOOO0OQ0:pOCIError;
OOQOOO0OQ0:IntPtr;OQQOOO0OQ0:ub4;OCQOOO0OQ0:ub4;O0COOO0OQ0:ub4):sword;cdecl;
var
OOCOOO0OQ0:OOCCQ0COQ0;
begin
OOCOOO0OQ0:=OOCCQ0COQ0(GetGCHandleTarget(OCOOOO0OQ0));
OOCOOO0OQ0.OQQCCQQOQ0:=OOO0CQQOQ0(GetGCHandleTarget(OQOOOO0OQ0));
OOCOOO0OQ0.O0CCCQQOQ0:=TrimRight(O0CQCQOOQ0(OOCOOO0OQ0.OOQCCQQOQ0.O00CQ0COQ0,OOQOOO0OQ0,OQQOOO0OQ0));
Result:=OOCOOO0OQ0.OQO0OQQOQ0(O0QOOO0OQ0);
end;
function OCIStmtGetNextResult_(OQCOOO0OQ0:pOCIStmt;OCCOOO0OQ0:pOCIError;
O00Q0O0OQ0:ppOCIStmt;out OO0Q0O0OQ0:ub4;OQ0Q0O0OQ0:ub4):sword;cdecl;
var
OC0Q0O0OQ0:OOCCQ0COQ0;
begin
OC0Q0O0OQ0:=OOCCQ0COQ0(GetGCHandleTarget(OQCOOO0OQ0));
Pointer(O00Q0O0OQ0^):=OOCCQ0COQ0(OC0Q0O0OQ0.O000CQQOQ0[OQ0Q0O0OQ0]).OQQOQOCOQ0;
OO0Q0O0OQ0:=OCI_RESULT_TYPE_SELECT;
Result:=OCI_SUCCESS;
end;
function OCIBindByName_(OQOCCQ0OQ0:pOCIStmt;var OCOCCQ0OQ0:pOCIBind;O0QCCQ0OQ0:pOCIError;
OOQCCQ0OQ0:IntPtr;OQQCCQ0OQ0:sb4;OCQCCQ0OQ0:IntPtr;O0CCCQ0OQ0:sb4;OOCCCQ0OQ0:ub2;
OQCCCQ0OQ0:IntPtr;OCCCCQ0OQ0:pub2;O000CQ0OQ0:pub2;OO00CQ0OQ0:ub4;OQ00CQ0OQ0:pub4;OC00CQ0OQ0:ub4):sword;cdecl;
begin
Result:=OOCCQ0COQ0(GetGCHandleTarget(OQOCCQ0OQ0)).O0CC0QQOQ0(OCOCCQ0OQ0,O0QCCQ0OQ0,OOQCCQ0OQ0,OQQCCQ0OQ0,OCQCCQ0OQ0,
O0CCCQ0OQ0,OOCCCQ0OQ0,OQCCCQ0OQ0,OCCCCQ0OQ0,OO00CQ0OQ0,OQ00CQ0OQ0);
end;
function OCIBindByPos_(OQQ0CQ0OQ0:pOCIStmt;var OCQ0CQ0OQ0:pOCIBind;O0C0CQ0OQ0:pOCIError;
OOC0CQ0OQ0:ub4;OQC0CQ0OQ0:IntPtr;OCC0CQ0OQ0:sb4;O00OCQ0OQ0:ub2;OO0OCQ0OQ0:IntPtr;
OQ0OCQ0OQ0:pub2;OC0OCQ0OQ0:pub2;O0OOCQ0OQ0:ub4;OOOOCQ0OQ0:pub4;OQOOCQ0OQ0:ub4):sword;cdecl;
begin
Result:=OOCCQ0COQ0(GetGCHandleTarget(OQQ0CQ0OQ0)).O0C00QQOQ0(OCQ0CQ0OQ0,O0C0CQ0OQ0,OOC0CQ0OQ0,OQC0CQ0OQ0,OCC0CQ0OQ0,O00OCQ0OQ0,OO0OCQ0OQ0,
OQ0OCQ0OQ0,O0OOCQ0OQ0,OOOOCQ0OQ0);
end;
function OCIBindArrayOfStruct_(O00CCQ0OQ0:pOCIBind;OO0CCQ0OQ0:pOCIError;OQ0CCQ0OQ0:ub4;
OC0CCQ0OQ0:ub4;O0OCCQ0OQ0:ub4;OOOCCQ0OQ0:ub4):sword;cdecl;
begin
Result:=OOQ0O0QOQ0(GetGCHandleTarget(O00CCQ0OQ0)).OQQ0O0QOQ0(OO0CCQ0OQ0,OQ0CCQ0OQ0,OC0CCQ0OQ0,O0OCCQ0OQ0);
end;
function OCIBindDynamic_(O0O0CQ0OQ0:pOCIBind;OOO0CQ0OQ0:pOCIError;OQO0CQ0OQ0:IntPtr;OCO0CQ0OQ0:IntPtr;
O0Q0CQ0OQ0:IntPtr;OOQ0CQ0OQ0:IntPtr):sword;cdecl;
begin
Result:=OOQ0O0QOQ0(GetGCHandleTarget(O0O0CQ0OQ0)).OCC0O0QOQ0(OOO0CQ0OQ0,OQO0CQ0OQ0,OCO0CQ0OQ0,O0Q0CQ0OQ0,OOQ0CQ0OQ0);
end;
function OCIDefineByPos_(OCCOCQ0OQ0:pOCIStmt;var O00QQQ0OQ0:pOCIDefine;OO0QQQ0OQ0:pOCIError;
OQ0QQQ0OQ0:ub4;OC0QQQ0OQ0:IntPtr;O0OQQQ0OQ0:sb4;OOOQQQ0OQ0:ub2;OQOQQQ0OQ0:IntPtr;OCOQQQ0OQ0:pub2;
O0QQQQ0OQ0:pub2;OOQQQQ0OQ0:ub4):sword;cdecl;
begin
Result:=OOCCQ0COQ0(GetGCHandleTarget(OCCOCQ0OQ0)).O0QQ0QQOQ0(O00QQQ0OQ0,OO0QQQ0OQ0,OQ0QQQ0OQ0,OC0QQQ0OQ0,O0OQQQ0OQ0,OOOQQQ0OQ0,OQOQQQ0OQ0,OCOQQQ0OQ0);
end;
function OCIDefineArrayOfStruct_(OOQOCQ0OQ0:pOCIDefine;OQQOCQ0OQ0:pOCIError;OCQOCQ0OQ0:ub4;
O0COCQ0OQ0:ub4;OOCOCQ0OQ0:ub4;OQCOCQ0OQ0:ub4):sword;cdecl;
begin
Result:=OO0OO0COQ0(GetGCHandleTarget(OOQOCQ0OQ0)).OQ0OO0COQ0(OQQOCQ0OQ0,OCQOCQ0OQ0,O0COCQ0OQ0,OOCOCQ0OQ0);
end;
function OCIDefineDynamic_(OQQQQQ0OQ0:pOCIDefine;OCQQQQ0OQ0:pOCIError;O0CQQQ0OQ0:IntPtr;OOCQQQ0OQ0:IntPtr):sword;cdecl;
begin
Result:=OO0OO0COQ0(GetGCHandleTarget(OQQQQQ0OQ0)).OCOOO0COQ0(OCQQQQ0OQ0,O0CQQQ0OQ0,OOCQQQ0OQ0);
end;
function OCILobCharSetForm_(OQQQ0O0OQ0:pOCIEnv;OCQQ0O0OQ0:pOCIError;const O0CQ0O0OQ0:pOCILobLocator;
var OOCQ0O0OQ0:ub1):sword;cdecl;
begin
OOCQ0O0OQ0:=OOCCQ0QOQ0(GetGCHandleTarget(O0CQ0O0OQ0)).OCC0OQOOQ0;
Result:=OCI_SUCCESS;
end;
function OCILobGetLength_(OQCQ0O0OQ0:pOCISvcCtx;OCCQ0O0OQ0:pOCIError;O00C0O0OQ0:pOCILobLocator;
var OO0C0O0OQ0:ub4):sword;cdecl;
begin
Result:=OOCCQ0QOQ0(GetGCHandleTarget(O00C0O0OQ0)).O0QC0COOQ0(OQCQ0O0OQ0,OCCQ0O0OQ0,OO0C0O0OQ0);
end;
function OCILobCreateTemporary_(OQ0C0O0OQ0:pOCISvcCtx;OC0C0O0OQ0:pOCIError;O0OC0O0OQ0:pOCILobLocator;
OOOC0O0OQ0:ub2;OQOC0O0OQ0:ub1;OCOC0O0OQ0:ub1;O0QC0O0OQ0:tbool;OOQC0O0OQ0:OCIDuration):sword;cdecl;
begin
if UseDirectLobs then
Result:=OOCCQ0QOQ0(GetGCHandleTarget(O0OC0O0OQ0)).OOQCQCOOQ0(OQ0C0O0OQ0,OC0C0O0OQ0,OOOC0O0OQ0,OQOC0O0OQ0,OCOC0O0OQ0,O0QC0O0OQ0,OOQC0O0OQ0)
else
Result:=OOCCQ0QOQ0(GetGCHandleTarget(O0OC0O0OQ0)).O0O0QCOOQ0(OQ0C0O0OQ0,OC0C0O0OQ0,OQOC0O0OQ0,OCOC0O0OQ0,O0QC0O0OQ0,OOQC0O0OQ0);
end;
function OCILobFreeTemporary_(OQQC0O0OQ0:pOCISvcCtx;OCQC0O0OQ0:pOCIError;O0CC0O0OQ0:pOCILobLocator):sword;cdecl;
begin
if UseDirectLobs then
Result:=OOCCQ0QOQ0(GetGCHandleTarget(O0CC0O0OQ0)).O0OOQCOOQ0(OQQC0O0OQ0,OCQC0O0OQ0)
else
Result:=OOCCQ0QOQ0(GetGCHandleTarget(O0CC0O0OQ0)).OOQOQCOOQ0(OQQC0O0OQ0,OCQC0O0OQ0);
end;
function OCILobIsTemporary_(OOCC0O0OQ0:pOCIEnv;OQCC0O0OQ0:pOCIError;OCCC0O0OQ0:pOCILobLocator;
var O0000O0OQ0:LongBool):sword;cdecl;
begin
Result:=OOCCQ0QOQ0(GetGCHandleTarget(OCCC0O0OQ0)).O0OQOQOOQ0(OOCC0O0OQ0,OQCC0O0OQ0,O0000O0OQ0);
end;
function OCILobLocatorIsInit_(OO000O0OQ0:pOCIEnv;OQ000O0OQ0:pOCIError;const OC000O0OQ0:pOCILobLocator;
var O0O00O0OQ0:tbool):sword;cdecl;
begin
Result:=OOCCQ0QOQ0(GetGCHandleTarget(OC000O0OQ0)).OOOC0COOQ0(OQ000O0OQ0,O0O00O0OQ0);
end;
function OCILobRead_(OOO00O0OQ0:pOCISvcCtx;OQO00O0OQ0:pOCIError;OCO00O0OQ0:pOCILobLocator;
var O0Q00O0OQ0:ub4;OOQ00O0OQ0:ub4;OQQ00O0OQ0:IntPtr;OCQ00O0OQ0:ub4;O0C00O0OQ0:IntPtr;
OOC00O0OQ0:IntPtr;OQC00O0OQ0:ub2;OCC00O0OQ0:ub1):sword;cdecl;
begin
if UseDirectLobs then
Result:=OOCCQ0QOQ0(GetGCHandleTarget(OCO00O0OQ0)).OQCC0COOQ0(OOO00O0OQ0,OQO00O0OQ0,O0Q00O0OQ0,OOQ00O0OQ0,OQQ00O0OQ0,OCQ00O0OQ0,OQC00O0OQ0,OCC00O0OQ0)
else
Result:=OOCCQ0QOQ0(GetGCHandleTarget(OCO00O0OQ0)).OOOO0COOQ0(OOO00O0OQ0,OQO00O0OQ0,O0Q00O0OQ0,OOQ00O0OQ0,OQQ00O0OQ0,OCQ00O0OQ0,OQC00O0OQ0);
end;
function OCILobTrim_(O00O0O0OQ0:pOCISvcCtx;OO0O0O0OQ0:pOCIError;OQ0O0O0OQ0:pOCILobLocator;
OC0O0O0OQ0:ub4):sword;cdecl;
begin
Result:=OOCCQ0QOQ0(GetGCHandleTarget(OQ0O0O0OQ0)).O0CQQCOOQ0(O00O0O0OQ0,OO0O0O0OQ0,OC0O0O0OQ0);
end;
function OCILobWrite_(O0OO0O0OQ0:pOCISvcCtx;OOOO0O0OQ0:pOCIError;OQOO0O0OQ0:pOCILobLocator;
var OCOO0O0OQ0:ub4;O0QO0O0OQ0:ub4;OOQO0O0OQ0:IntPtr;OQQO0O0OQ0:ub4;OCQO0O0OQ0:ub1;
O0CO0O0OQ0:IntPtr;OOCO0O0OQ0:IntPtr;OQCO0O0OQ0:ub2;OCCO0O0OQ0:ub1):sword;cdecl;
begin
if UseDirectLobs then
Result:=OOCCQ0QOQ0(GetGCHandleTarget(OQOO0O0OQ0)).OCQ00COOQ0(O0OO0O0OQ0,OOOO0O0OQ0,OCOO0O0OQ0,O0QO0O0OQ0,OOQO0O0OQ0,OQQO0O0OQ0,OCQO0O0OQ0,OQCO0O0OQ0,OCCO0O0OQ0)
else
Result:=OOCCQ0QOQ0(GetGCHandleTarget(OQOO0O0OQ0)).OQOCCCOOQ0(O0OO0O0OQ0,OOOO0O0OQ0,OCOO0O0OQ0,O0QO0O0OQ0,OOQO0O0OQ0,OQQO0O0OQ0,OCQO0O0OQ0,OQCO0O0OQ0);
end;
function OCILobFileExists_(O00QCO0OQ0:pOCISvcCtx;OO0QCO0OQ0:pOCIError;OQ0QCO0OQ0:pOCILobLocator;
var OC0QCO0OQ0:tbool):sword;cdecl;
begin
Result:=OOCCQ0QOQ0(GetGCHandleTarget(OQ0QCO0OQ0)).O0QQOQOOQ0(O00QCO0OQ0,OO0QCO0OQ0,OC0QCO0OQ0)
end;
function OCILobFileIsOpen_(O0OQCO0OQ0:pOCISvcCtx;OOOQCO0OQ0:pOCIError;OQOQCO0OQ0:pOCILobLocator;
var OCOQCO0OQ0:tbool):sword;cdecl;
begin
Result:=OOCCQ0QOQ0(GetGCHandleTarget(OQOQCO0OQ0)).OQCQOQOOQ0(O0OQCO0OQ0,OOOQCO0OQ0,OCOQCO0OQ0)
end;
function OCILobFileOpen_(O0QQCO0OQ0:pOCISvcCtx;OOQQCO0OQ0:pOCIError;OQQQCO0OQ0:pOCILobLocator;
OCQQCO0OQ0:ub1):sword;cdecl;
begin
Result:=OOCCQ0QOQ0(GetGCHandleTarget(OQQQCO0OQ0)).OQ0COQOOQ0(O0QQCO0OQ0,OOQQCO0OQ0)
end;
function OCILobFileClose_(O0CQCO0OQ0:pOCISvcCtx;OOCQCO0OQ0:pOCIError;OQCQCO0OQ0:pOCILobLocator):sword;cdecl;
begin
Result:=OOCCQ0QOQ0(GetGCHandleTarget(OQCQCO0OQ0)).OCOCOQOOQ0(O0CQCO0OQ0,OOCQCO0OQ0)
end;
function OCILobFileGetName_(OCCQCO0OQ0:pOCIEnv;O00CCO0OQ0:pOCIError;const OO0CCO0OQ0:pOCILobLocator;
OQ0CCO0OQ0:IntPtr;OC0CCO0OQ0:pub2;O0OCCO0OQ0:IntPtr;OOOCCO0OQ0:pub2):sword;cdecl;
begin
Result:=OOCCQ0QOQ0(GetGCHandleTarget(OO0CCO0OQ0)).O0CCOQOOQ0(OQ0CCO0OQ0,OC0CCO0OQ0,O0OCCO0OQ0,OOOCCO0OQ0)
end;
function OCILobFileSetName_(OQOCCO0OQ0:pOCIEnv;OCOCCO0OQ0:pOCIError;O0QCCO0OQ0:ppOCILobLocator;
const OOQCCO0OQ0:IntPtr;OQQCCO0OQ0:ub2;const OCQCCO0OQ0:IntPtr;
O0CCCO0OQ0:ub2):sword;cdecl;
var
OOCCCO0OQ0:pOCILobLocator;
begin
OOCCCO0OQ0:=O0QCCO0OQ0^;
if OOCCCO0OQ0<>nil then
Result:=OOCCQ0QOQ0(GetGCHandleTarget(OOCCCO0OQ0)).O0O0OQOOQ0(OOQCCO0OQ0,OQQCCO0OQ0,OCQCCO0OQ0,O0CCCO0OQ0)
else
Result:=OCI_ERROR;
end;
function OCINumberAssign_(OQCCCO0OQ0:pOCIError;const OCCCCO0OQ0:pOCINumber;O000CO0OQ0:pOCINumber):sword;cdecl;
var
OO00CO0OQ0:TBytes;
begin
SetLength(OO00CO0OQ0,Marshal.ReadByte(OCCCCO0OQ0));
Marshal.Copy(PtrOffset(OCCCCO0OQ0,1),OO00CO0OQ0,0,Length(OO00CO0OQ0));
Marshal.WriteByte(O000CO0OQ0,Length(OO00CO0OQ0));
Marshal.Copy(OO00CO0OQ0,0,PtrOffset(O000CO0OQ0,1),Length(OO00CO0OQ0));
Result:=OCI_SUCCESS;
end;
function OCINumberCmp_(OQ00CO0OQ0:pOCIError;const OC00CO0OQ0:pOCINumber;const O0O0CO0OQ0:pOCINumber;
var OOO0CO0OQ0:sword):sword;cdecl;
var
OQO0CO0OQ0,OCO0CO0OQ0:TBytes;
begin
SetLength(OQO0CO0OQ0,Marshal.ReadByte(OC00CO0OQ0));
Marshal.Copy(PtrOffset(OC00CO0OQ0,1),OQO0CO0OQ0,0,Length(OQO0CO0OQ0));
SetLength(OCO0CO0OQ0,Marshal.ReadByte(O0O0CO0OQ0));
Marshal.Copy(PtrOffset(O0O0CO0OQ0,1),OCO0CO0OQ0,0,Length(OCO0CO0OQ0));
OOO0CO0OQ0:=TOCINumber.Compare(OQO0CO0OQ0,OCO0CO0OQ0);
Result:=OCI_SUCCESS;
end;
function OCINumberFromInt_(O0Q0CO0OQ0:pOCIError;var OOQ0CO0OQ0:int64;OQQ0CO0OQ0:uword;
OCQ0CO0OQ0:uword;O0C0CO0OQ0:pOCINumber):sword;cdecl;
var
OOC0CO0OQ0:TBytes;
begin
OOC0CO0OQ0:=TOCINumber.FromInt(OOQ0CO0OQ0,OQQ0CO0OQ0,OCQ0CO0OQ0);
Marshal.WriteByte(O0C0CO0OQ0,Length(OOC0CO0OQ0));
Marshal.Copy(OOC0CO0OQ0,0,PtrOffset(O0C0CO0OQ0,1),Length(OOC0CO0OQ0));
Result:=OCI_SUCCESS;
end;
function OCINumberFromReal_(OQC0CO0OQ0:pOCIError;var OCC0CO0OQ0:double;O00OCO0OQ0:uword;
OO0OCO0OQ0:pOCINumber):sword;cdecl;
var
OQ0OCO0OQ0:TBytes;
begin
OQ0OCO0OQ0:=TOCINumber.FromReal(OCC0CO0OQ0,O00OCO0OQ0);
Marshal.WriteByte(OO0OCO0OQ0,Length(OQ0OCO0OQ0));
Marshal.Copy(OQ0OCO0OQ0,0,PtrOffset(OO0OCO0OQ0,1),Length(OQ0OCO0OQ0));
Result:=OCI_SUCCESS;
end;
function OCINumberFromText_(OC0OCO0OQ0:pOCIError;const O0OOCO0OQ0:IntPtr;OOOOCO0OQ0:ub4;
const OQOOCO0OQ0:IntPtr;OCOOCO0OQ0:ub4;const O0QOCO0OQ0:IntPtr;OOQOCO0OQ0:ub4;
OQQOCO0OQ0:pOCINumber):sword;cdecl;
var
OCQOCO0OQ0:TBytes;
O0COCO0OQ0:O0CQQ0COQ0;
OOCOCO0OQ0,OQCOCO0OQ0:string;
begin
O0COCO0OQ0:=O0CQQ0COQ0(OQ0CQ0COQ0(GetGCHandleTarget(OC0OCO0OQ0)).OCQOQOCOQ0);
OOCOCO0OQ0:=O0CQCQOOQ0(O0COCO0OQ0.O00CQ0COQ0,O0OOCO0OQ0,OOOOCO0OQ0);
OQCOCO0OQ0:=O0CQCQOOQ0(O0COCO0OQ0.O00CQ0COQ0,OQOOCO0OQ0,OCOOCO0OQ0);
Result:=TOCINumber.Parse(OOCOCO0OQ0,OQCOCO0OQ0,OCQOCO0OQ0);
Marshal.WriteByte(OQQOCO0OQ0,Length(OCQOCO0OQ0));
Marshal.Copy(OCQOCO0OQ0,0,PtrOffset(OQQOCO0OQ0,1),Length(OCQOCO0OQ0));
end;
function OCINumberToInt_(OCCOCO0OQ0:pOCIError;O00QQO0OQ0:pOCINumber;OO0QQO0OQ0:uword;
OQ0QQO0OQ0:uword;var OC0QQO0OQ0:int64):sword;cdecl;
var
O0OQQO0OQ0:TBytes;
begin
SetLength(O0OQQO0OQ0,Marshal.ReadByte(O00QQO0OQ0));
Marshal.Copy(PtrOffset(O00QQO0OQ0,1),O0OQQO0OQ0,0,Length(O0OQQO0OQ0));
OC0QQO0OQ0:=TOCINumber.ToInt(O0OQQO0OQ0,OO0QQO0OQ0,OQ0QQO0OQ0);
Result:=OCI_SUCCESS;
end;
function OCINumberToReal_(OOOQQO0OQ0:pOCIError;const OQOQQO0OQ0:pOCINumber;OCOQQO0OQ0:uword;
var O0QQQO0OQ0:double):sword;cdecl;
var
OOQQQO0OQ0:TBytes;
begin
SetLength(OOQQQO0OQ0,Marshal.ReadByte(OQOQQO0OQ0));
Marshal.Copy(PtrOffset(OQOQQO0OQ0,1),OOQQQO0OQ0,0,Length(OOQQQO0OQ0));
O0QQQO0OQ0:=TOCINumber.ToReal(OOQQQO0OQ0,OCOQQO0OQ0);
Result:=OCI_SUCCESS;
end;
function OCINumberToText_(OQQQQO0OQ0:pOCIError;OCQQQO0OQ0:pOCINumber;const O0CQQO0OQ0:IntPtr;
OOCQQO0OQ0:ub4;const OQCQQO0OQ0:IntPtr;OCCQQO0OQ0:ub4;var O00CQO0OQ0:ub4;
OO0CQO0OQ0:IntPtr):sword;cdecl;
var
OQ0CQO0OQ0:TBytes;
OC0CQO0OQ0:O0CQQ0COQ0;
O0OCQO0OQ0,OOOCQO0OQ0:string;
begin
OC0CQO0OQ0:=O0CQQ0COQ0(OQ0CQ0COQ0(GetGCHandleTarget(OQQQQO0OQ0)).OCQOQOCOQ0);
SetLength(OQ0CQO0OQ0,Marshal.ReadByte(OCQQQO0OQ0));
Marshal.Copy(PtrOffset(OCQQQO0OQ0,1),OQ0CQO0OQ0,0,Length(OQ0CQO0OQ0));
O0OCQO0OQ0:=O0CQCQOOQ0(OC0CQO0OQ0.O00CQ0COQ0,O0CQQO0OQ0,OOCQQO0OQ0);
OOOCQO0OQ0:=TOCINumber.ToString(OQ0CQO0OQ0,O0OCQO0OQ0);
O00CQO0OQ0:=O0OCCQOOQ0(OOOCQO0OQ0,OO0CQO0OQ0,O00CQO0OQ0,OC0CQO0OQ0.O00CQ0COQ0);
Result:=OCI_SUCCESS;
end;
function OCIDateTimeAssign_(OQOCQO0OQ0:IntPtr;OCOCQO0OQ0:pOCIError;O0QCQO0OQ0:pOCIDateTime;
OOQCQO0OQ0:pOCIDateTime):sword;cdecl;
var
OQQCQO0OQ0:TOCIDateTime;
OCQCQO0OQ0:TOCIDateTime;
begin
OQQCQO0OQ0:=O00O0QOOQ0(GetGCHandleTarget(O0QCQO0OQ0)).OC0O0QOOQ0;
OCQCQO0OQ0:=O00O0QOOQ0(GetGCHandleTarget(OOQCQO0OQ0)).OC0O0QOOQ0;
OCQCQO0OQ0.Assign(OQQCQO0OQ0);
Result:=OCI_SUCCESS;
end;
function OCIDateTimeCheck_(O0CCQO0OQ0:IntPtr;OOCCQO0OQ0:pOCIError;OQCCQO0OQ0:pOCIDateTime;
var OCCCQO0OQ0:ub4):sword;cdecl;
var
O000QO0OQ0:TOCIDateTime;
begin
O000QO0OQ0:=O00O0QOOQ0(GetGCHandleTarget(OQCCQO0OQ0)).OC0O0QOOQ0;
OCCCQO0OQ0:=O000QO0OQ0.Check;
Result:=OCI_SUCCESS;
end;
function OCIDateTimeCompare_(OO00QO0OQ0:IntPtr;OQ00QO0OQ0:pOCIError;const OC00QO0OQ0:pOCIDateTime;
const O0O0QO0OQ0:pOCIDateTime;var OOO0QO0OQ0:sword):sword;cdecl;
var
OQO0QO0OQ0:TOCIDateTime;
OCO0QO0OQ0:TOCIDateTime;
begin
OQO0QO0OQ0:=O00O0QOOQ0(GetGCHandleTarget(OC00QO0OQ0)).OC0O0QOOQ0;
OCO0QO0OQ0:=O00O0QOOQ0(GetGCHandleTarget(O0O0QO0OQ0)).OC0O0QOOQ0;
OOO0QO0OQ0:=OQO0QO0OQ0.Compare(OCO0QO0OQ0);
Result:=OCI_SUCCESS;
end;
function OCIDateTimeConstruct_(O0Q0QO0OQ0:IntPtr;OOQ0QO0OQ0:pOCIError;OQQ0QO0OQ0:pOCIDateTime;
OCQ0QO0OQ0:sb2;O0C0QO0OQ0,OOC0QO0OQ0,OQC0QO0OQ0,OCC0QO0OQ0,O00OQO0OQ0:ub1;OO0OQO0OQ0:ub4;OQ0OQO0OQ0:IntPtr;
OC0OQO0OQ0:integer):sword;cdecl;
var
O0OOQO0OQ0:O0CQQ0COQ0;
OOOOQO0OQ0:TOCIDateTime;
OQOOQO0OQ0:string;
begin
O0OOQO0OQ0:=O0CQQ0COQ0(OQ0CQ0COQ0(GetGCHandleTarget(OOQ0QO0OQ0)).OCQOQOCOQ0);
OQOOQO0OQ0:=O0CQCQOOQ0(O0OOQO0OQ0.O00CQ0COQ0,OQ0OQO0OQ0,OC0OQO0OQ0);
OOOOQO0OQ0:=O00O0QOOQ0(GetGCHandleTarget(OQQ0QO0OQ0)).OC0O0QOOQ0;
OOOOQO0OQ0.Construct(OCQ0QO0OQ0,O0C0QO0OQ0,OOC0QO0OQ0,OQC0QO0OQ0,OCC0QO0OQ0,O00OQO0OQ0,OO0OQO0OQ0,OQOOQO0OQ0);
Result:=OCI_SUCCESS;
end;
function OCIDateTimeFromText_(OCOOQO0OQ0:IntPtr;O0QOQO0OQ0:pOCIError;OOQOQO0OQ0:IntPtr;
OQQOQO0OQ0:integer;OCQOQO0OQ0:IntPtr;O0COQO0OQ0:ub1;OOCOQO0OQ0:IntPtr;
OQCOQO0OQ0:integer;OCCOQO0OQ0:pOCIDateTime):sword;cdecl;
var
O00QO00OQ0:O0CQQ0COQ0;
OO0QO00OQ0:TOCIDateTime;
OQ0QO00OQ0,OC0QO00OQ0:string;
begin
O00QO00OQ0:=O0CQQ0COQ0(OQ0CQ0COQ0(GetGCHandleTarget(O0QOQO0OQ0)).OCQOQOCOQ0);
OC0QO00OQ0:=O0CQCQOOQ0(O00QO00OQ0.O00CQ0COQ0,OCQOQO0OQ0,O0COQO0OQ0);
OQ0QO00OQ0:=O0CQCQOOQ0(O00QO00OQ0.O00CQ0COQ0,OOQOQO0OQ0,OQQOQO0OQ0);
OO0QO00OQ0:=O00O0QOOQ0(GetGCHandleTarget(OCCOQO0OQ0)).OC0O0QOOQ0;
OO0QO00OQ0.Parse(OQ0QO00OQ0,OC0QO00OQ0);
Result:=OCI_SUCCESS;
end;
function OCIDateTimeToText_(O0OQO00OQ0:IntPtr;OOOQO00OQ0:pOCIError;OQOQO00OQ0:pOCIDateTime;OCOQO00OQ0:IntPtr;
O0QQO00OQ0,OOQQO00OQ0:ub1;OQQQO00OQ0:IntPtr;OCQQO00OQ0:integer;var O0CQO00OQ0:ub4;
OOCQO00OQ0:IntPtr):sword;cdecl;
var
OQCQO00OQ0:O0CQQ0COQ0;
OCCQO00OQ0:OQ0CQ0COQ0;
O00CO00OQ0:TOCIDateTime;
OO0CO00OQ0:string;
begin
OQCQO00OQ0:=O0CQQ0COQ0(OQ0CQ0COQ0(GetGCHandleTarget(OOOQO00OQ0)).OCQOQOCOQ0);
OO0CO00OQ0:=O0CQCQOOQ0(OQCQO00OQ0.O00CQ0COQ0,OCOQO00OQ0,O0QQO00OQ0);
try
O00CO00OQ0:=O00O0QOOQ0(GetGCHandleTarget(OQOQO00OQ0)).OC0O0QOOQ0;
O0CQO00OQ0:=O0OCCQOOQ0(O00CO00OQ0.ToString(OO0CO00OQ0,OOQQO00OQ0),OOCQO00OQ0,O0CQO00OQ0,OQCQO00OQ0.O00CQ0COQ0);
Result:=OCI_SUCCESS;
except
on E:EConvertError do begin
OCCQO00OQ0:=OQ0CQ0COQ0(GetGCHandleTarget(OOOQO00OQ0));
OCCQO00OQ0.OQOCQ0COQ0:=01877;
OCCQO00OQ0.OCOCQ0COQ0:='ORA-01877: string is too long for internal buffer'#$A;
Result:=OCI_ERROR;
end;
end
end;
function OCIDateTimeGetDate_(OQ0CO00OQ0:IntPtr;OC0CO00OQ0:pOCIError;O0OCO00OQ0:pOCIDateTime;
var OOOCO00OQ0:sb2;var OQOCO00OQ0:ub1;var OCOCO00OQ0:ub1):sword;cdecl;
var
O0QCO00OQ0:TOCIDateTime;
begin
O0QCO00OQ0:=O00O0QOOQ0(GetGCHandleTarget(O0OCO00OQ0)).OC0O0QOOQ0;
O0QCO00OQ0.GetDate(OOOCO00OQ0,OQOCO00OQ0,OCOCO00OQ0);
Result:=OCI_SUCCESS;
end;
function OCIDateTimeGetTime_(OOQCO00OQ0:IntPtr;OQQCO00OQ0:pOCIError;OCQCO00OQ0:pOCIDateTime;
var O0CCO00OQ0:ub1;var OOCCO00OQ0:ub1;var OQCCO00OQ0:ub1;var OCCCO00OQ0:ub4):sword;cdecl;
var
O000O00OQ0:TOCIDateTime;
begin
O000O00OQ0:=O00O0QOOQ0(GetGCHandleTarget(OCQCO00OQ0)).OC0O0QOOQ0;
O000O00OQ0.GetTime(O0CCO00OQ0,OOCCO00OQ0,OQCCO00OQ0,OCCCO00OQ0);
Result:=OCI_SUCCESS;
end;
function OCIDateTimeGetTimeZoneOffset_(OO00O00OQ0:IntPtr;OQ00O00OQ0:pOCIError;OC00O00OQ0:pOCIDateTime;
var O0O0O00OQ0:sb1;var OOO0O00OQ0:sb1):sword;cdecl;
var
OQO0O00OQ0:TOCIDateTime;
begin
OQO0O00OQ0:=O00O0QOOQ0(GetGCHandleTarget(OC00O00OQ0)).OC0O0QOOQ0;
OQO0O00OQ0.GetTimeZoneOffset(O0O0O00OQ0,OOO0O00OQ0);
Result:=OCI_SUCCESS;
end;
function OCIDateTimeGetTimeZoneName_(OCO0O00OQ0:IntPtr;O0Q0O00OQ0:pOCIError;OOQ0O00OQ0:pOCIDateTime;
OQQ0O00OQ0:pub1;var OCQ0O00OQ0:ub4):sword;cdecl;
var
O0C0O00OQ0:O0CQQ0COQ0;
OOC0O00OQ0:TOCIDateTime;
begin
O0C0O00OQ0:=O0CQQ0COQ0(OQ0CQ0COQ0(GetGCHandleTarget(O0Q0O00OQ0)).OCQOQOCOQ0);
OOC0O00OQ0:=O00O0QOOQ0(GetGCHandleTarget(OOQ0O00OQ0)).OC0O0QOOQ0;
OCQ0O00OQ0:=O0OCCQOOQ0(OOC0O00OQ0.GetTimeZoneName,OQQ0O00OQ0,OCQ0O00OQ0,O0C0O00OQ0.O00CQ0COQ0);
Result:=OCI_SUCCESS;
end;
function OCIIntervalAssign_(OQC0O00OQ0:IntPtr;OCC0O00OQ0:pOCIError;O00OO00OQ0:pOCIInterval;
OO0OO00OQ0:pOCIInterval):sword;cdecl;
var
OQ0OO00OQ0:TOCIInterval;
OC0OO00OQ0:TOCIInterval;
begin
OQ0OO00OQ0:=O0OO0QOOQ0(GetGCHandleTarget(OO0OO00OQ0)).OQOO0QOOQ0;
OC0OO00OQ0:=O0OO0QOOQ0(GetGCHandleTarget(O00OO00OQ0)).OQOO0QOOQ0;
OQ0OO00OQ0.Assign(OC0OO00OQ0);
Result:=OCI_SUCCESS;
end;
function OCIIntervalCheck_(O0OOO00OQ0:IntPtr;OOOOO00OQ0:pOCIError;OQOOO00OQ0:pOCIInterval;
var OCOOO00OQ0:ub4):sword;cdecl;
var
O0QOO00OQ0:TOCIInterval;
begin
O0QOO00OQ0:=O0OO0QOOQ0(GetGCHandleTarget(OQOOO00OQ0)).OQOO0QOOQ0;
OCOOO00OQ0:=O0QOO00OQ0.Check;
Result:=OCI_SUCCESS;
end;
function OCIIntervalCompare_(OOQOO00OQ0:IntPtr;OQQOO00OQ0:pOCIError;OCQOO00OQ0:pOCIInterval;
O0COO00OQ0:pOCIInterval;var OOCOO00OQ0:sword):sword;cdecl;
var
OQCOO00OQ0:TOCIInterval;
OCCOO00OQ0:TOCIInterval;
begin
OQCOO00OQ0:=O0OO0QOOQ0(GetGCHandleTarget(OCQOO00OQ0)).OQOO0QOOQ0;
OCCOO00OQ0:=O0OO0QOOQ0(GetGCHandleTarget(O0COO00OQ0)).OQOO0QOOQ0;
OOCOO00OQ0:=OQCOO00OQ0.Compare(OCCOO00OQ0);
Result:=OCI_SUCCESS;
end;
function OCIIntervalFromText_(O00Q000OQ0:IntPtr;OO0Q000OQ0:pOCIError;OQ0Q000OQ0:IntPtr;
OC0Q000OQ0:integer;O0OQ000OQ0:pOCIInterval):sword;cdecl;
var
OOOQ000OQ0:O0CQQ0COQ0;
OQOQ000OQ0:TOCIInterval;
OCOQ000OQ0:string;
begin
OOOQ000OQ0:=O0CQQ0COQ0(OQ0CQ0COQ0(GetGCHandleTarget(OO0Q000OQ0)).OCQOQOCOQ0);
OCOQ000OQ0:=O0CQCQOOQ0(OOOQ000OQ0.O00CQ0COQ0,OQ0Q000OQ0,OC0Q000OQ0);
OQOQ000OQ0:=O0OO0QOOQ0(GetGCHandleTarget(O0OQ000OQ0)).OQOO0QOOQ0;
OQOQ000OQ0.Parse(OCOQ000OQ0);
Result:=OCI_SUCCESS;
end;
function OCIIntervalToText_(O0QQ000OQ0:IntPtr;OOQQ000OQ0:pOCIError;OQQQ000OQ0:pOCIInterval;
OCQQ000OQ0,O0CQ000OQ0:ub1;OOCQ000OQ0:IntPtr;OQCQ000OQ0:NativeUInt;var OCCQ000OQ0:NativeUInt):sword;cdecl;
var
O00C000OQ0:O0CQQ0COQ0;
OO0C000OQ0:TOCIInterval;
begin
O00C000OQ0:=O0CQQ0COQ0(OQ0CQ0COQ0(GetGCHandleTarget(OOQQ000OQ0)).OCQOQOCOQ0);
OO0C000OQ0:=O0OO0QOOQ0(GetGCHandleTarget(OQQQ000OQ0)).OQOO0QOOQ0;
OCCQ000OQ0:=O0OCCQOOQ0(OO0C000OQ0.ToString(OCQQ000OQ0,O0CQ000OQ0),OOCQ000OQ0,OQCQ000OQ0,O00C000OQ0.O00CQ0COQ0);
Result:=OCI_SUCCESS;
end;
function OCIIntervalSetYearMonth_(OQ0C000OQ0:IntPtr;OC0C000OQ0:pOCIError;O0OC000OQ0,OOOC000OQ0:sb4;
OQOC000OQ0:pOCIInterval):sword;cdecl;
var
OCOC000OQ0:TOCIIntervalYM;
begin
OCOC000OQ0:=O0OO0QOOQ0(GetGCHandleTarget(OQOC000OQ0)).OQOO0QOOQ0 as TOCIIntervalYM;
OCOC000OQ0.SetYearMonth(O0OC000OQ0,OOOC000OQ0);
Result:=OCI_SUCCESS;
end;
function OCIIntervalGetYearMonth_(O0QC000OQ0:IntPtr;OOQC000OQ0:pOCIError;var OQQC000OQ0:sb4;var OCQC000OQ0:sb4;
O0CC000OQ0:pOCIInterval):sword;cdecl;
var
OOCC000OQ0:TOCIIntervalYM;
begin
OOCC000OQ0:=O0OO0QOOQ0(GetGCHandleTarget(O0CC000OQ0)).OQOO0QOOQ0 as TOCIIntervalYM;
OOCC000OQ0.GetYearMonth(OQQC000OQ0,OCQC000OQ0);
Result:=OCI_SUCCESS;
end;
function OCIIntervalSetDaySecond_(OQCC000OQ0:IntPtr;OCCC000OQ0:pOCIError;O000000OQ0,OO00000OQ0,
OQ00000OQ0,OC00000OQ0,O0O0000OQ0:sb4;OOO0000OQ0:pOCIInterval):sword;cdecl;
var
OQO0000OQ0:TOCIIntervalDS;
begin
OQO0000OQ0:=O0OO0QOOQ0(GetGCHandleTarget(OOO0000OQ0)).OQOO0QOOQ0 as TOCIIntervalDS;
OQO0000OQ0.SetDaySecond(O000000OQ0,OO00000OQ0,OQ00000OQ0,OC00000OQ0,O0O0000OQ0);
Result:=OCI_SUCCESS;
end;
function OCIIntervalGetDaySecond_(OCO0000OQ0:IntPtr;O0Q0000OQ0:pOCIError;var OOQ0000OQ0:sb4;var OQQ0000OQ0:sb4;
var OCQ0000OQ0:sb4;var O0C0000OQ0:sb4;var OOC0000OQ0:sb4;OQC0000OQ0:pOCIInterval):sword;cdecl;
var
OCC0000OQ0:TOCIIntervalDS;
begin
OCC0000OQ0:=O0OO0QOOQ0(GetGCHandleTarget(OQC0000OQ0)).OQOO0QOOQ0 as TOCIIntervalDS;
OCC0000OQ0.GetDaySecond(OOQ0000OQ0,OQQ0000OQ0,OCQ0000OQ0,O0C0000OQ0,OOC0000OQ0);
Result:=OCI_SUCCESS;
end;
function OCIIntervalFromNumber_(O00O000OQ0:IntPtr;OO0O000OQ0:pOCIError;OQ0O000OQ0:pOCIInterval;
OC0O000OQ0:pOCINumber):sword;cdecl;
var
O0OO000OQ0:TOCIInterval;
begin
O0OO000OQ0:=O0OO0QOOQ0(GetGCHandleTarget(OQ0O000OQ0)).OQOO0QOOQ0;
O0OO000OQ0.FromNumber(OC0O000OQ0);
Result:=OCI_SUCCESS;
end;
function OCIRowIdToChar_(OOOO000OQ0:IntPtr;OQOO000OQ0:IntPtr;var OCOO000OQ0:ub2;
O0QO000OQ0:pOCIError):sword;cdecl;
begin
OCOO000OQ0:=O0OCCQOOQ0(OOOCO0QOQ0(GetGCHandleTarget(OOOO000OQ0)).OQCCO0QOQ0,OQOO000OQ0,OCOO000OQ0,false);
Result:=OCI_SUCCESS;
end;
function OCIStringAllocSize_(OOQO000OQ0:pOCIEnv;OQQO000OQ0:pOCIError;const OCQO000OQ0:pOCIString;O0CO000OQ0:pub4):sword;cdecl;
var
OOCO000OQ0:OCQOC0QOQ0;
begin
OOCO000OQ0:=OCQOC0QOQ0(GetGCHandleTarget(OCQO000OQ0));
ub4(O0CO000OQ0^):=OOCO000OQ0.OCOCQ0QOQ0;
Result:=OCI_SUCCESS;
end;
function OCIStringAssign_(OQCO000OQ0:pOCIEnv;OCCO000OQ0:pOCIError;const O00QC00OQ0:pOCIString;
OO0QC00OQ0:ppOCIString):sword;cdecl;
var
OQ0QC00OQ0:OCQOC0QOQ0;
OC0QC00OQ0:OCQOC0QOQ0;
begin
OQ0QC00OQ0:=OCQOC0QOQ0(GetGCHandleTarget(O00QC00OQ0));
OC0QC00OQ0:=OCQOC0QOQ0(GetGCHandleTarget(Marshal.ReadIntPtr(OO0QC00OQ0)));
OC0QC00OQ0.OCCQQ0QOQ0(OQ0QC00OQ0);
Result:=OCI_SUCCESS;
end;
function OCIStringAssignText_(O0OQC00OQ0:pOCIEnv;OOOQC00OQ0:pOCIError;const OQOQC00OQ0:IntPtr;
OCOQC00OQ0:ub4;O0QQC00OQ0:ppOCIString):sword;cdecl;
var
OOQQC00OQ0:O0CQQ0COQ0;
OQQQC00OQ0:OCQOC0QOQ0;
begin
OQQQC00OQ0:=OCQOC0QOQ0(GetGCHandleTarget(Marshal.ReadIntPtr(O0QQC00OQ0)));
if OQQQC00OQ0=nil then begin
OOQQC00OQ0:=O0CQQ0COQ0(GetGCHandleTarget(O0OQC00OQ0));
OQQQC00OQ0:=OCQOC0QOQ0.Create(OOQQC00OQ0);
Marshal.WriteIntPtr(O0QQC00OQ0,OQQQC00OQ0.OQQOQOCOQ0);
end;
OQQQC00OQ0.OC0CQ0QOQ0(OQOQC00OQ0,OCOQC00OQ0);
Marshal.WriteIntPtr(O0QQC00OQ0,OQQQC00OQ0.OQQOQOCOQ0);
Result:=OCI_SUCCESS;
end;
function OCIStringPtr_(OCQQC00OQ0:pOCIEnv;const O0CQC00OQ0:pOCIString):IntPtr;cdecl;
var
OOCQC00OQ0:OCQOC0QOQ0;
begin
OOCQC00OQ0:=OCQOC0QOQ0(GetGCHandleTarget(O0CQC00OQ0));
Result:=OOCQC00OQ0.OQOCQ0QOQ0;
end;
function OCIStringResize_(OQCQC00OQ0:pOCIEnv;OCCQC00OQ0:pOCIError;O00CC00OQ0:ub4;OO0CC00OQ0:ppOCIString):sword;cdecl;
var
OQ0CC00OQ0:OCQOC0QOQ0;
begin
OQ0CC00OQ0:=OCQOC0QOQ0(GetGCHandleTarget(Marshal.ReadIntPtr(OO0CC00OQ0)));
OQ0CC00OQ0.OCOCQ0QOQ0:=O00CC00OQ0;
Result:=OCI_SUCCESS;
end;
function OCIStringSize_(OC0CC00OQ0:pOCIEnv;const O0OCC00OQ0:pOCIString):ub4;cdecl;
var
OOOCC00OQ0:OCQOC0QOQ0;
begin
OOOCC00OQ0:=OCQOC0QOQ0(GetGCHandleTarget(O0OCC00OQ0));
Result:=OOOCC00OQ0.O0QCQ0QOQ0;
end;
function OCIDescribeAny_(OQOCC00OQ0:pOCISvcCtx;OCOCC00OQ0:pOCIError;O0QCC00OQ0:IntPtr;
OOQCC00OQ0:ub4;OQQCC00OQ0:ub1;OCQCC00OQ0:ub1;O0CCC00OQ0:ub1;
OOCCC00OQ0:pOCIDescribe):sword;cdecl;
var
OQCCC00OQ0:OOO0CQQOQ0;
OCCCC00OQ0:OCQOO0COQ0;
O000C00OQ0:string;
begin
OQCCC00OQ0:=OOO0CQQOQ0(GetGCHandleTarget(OQOCC00OQ0));
OCCCC00OQ0:=OCQOO0COQ0(GetGCHandleTarget(OOCCC00OQ0));
try
case O0CCC00OQ0 of
OCI_PTYPE_UNK,
OCI_PTYPE_PROC,
OCI_PTYPE_FUNC,
OCI_PTYPE_PKG:begin
O000C00OQ0:=O0CQCQOOQ0(OQCCC00OQ0.OOCOQOQOQ0.O00CQ0COQ0,O0QCC00OQ0,OOQCC00OQ0);
Result:=OCCCC00OQ0.O0OQQ0COQ0(OQCCC00OQ0,O000C00OQ0,O0CCC00OQ0,OCOCC00OQ0);
end;
OCI_PTYPE_TYPE:
case OQQCC00OQ0 of
OCI_OTYPE_NAME:begin
O000C00OQ0:=O0CQCQOOQ0(OQCCC00OQ0.OOCOQOQOQ0.O00CQ0COQ0,O0QCC00OQ0,OOQCC00OQ0);
Result:=OCCCC00OQ0.OOCOC0COQ0(OQCCC00OQ0,O000C00OQ0,OCOCC00OQ0);
end;
OCI_OTYPE_PTR:begin
OCCCC00OQ0.OQQQQ0COQ0:=O0Q0QQOOQ0(GetGCHandleTarget(O0QCC00OQ0));
Result:=OCI_SUCCESS;
end;
else
Result:=OCI_INVALID_HANDLE;
end;
else
Result:=OCI_INVALID_HANDLE;
end;
except
on E:Exception do begin
Result:=OQCCC00OQ0.OOOCQOQOQ0(E,OCOCC00OQ0);
end;
end;
end;
function OCITypeByName_(OO00C00OQ0:pOCIEnv;OQ00C00OQ0:pOCIError;const OC00C00OQ0:pOCISvcCtx;
const O0O0C00OQ0:IntPtr;OOO0C00OQ0:ub4;const OQO0C00OQ0:IntPtr;
OCO0C00OQ0:ub4;O0Q0C00OQ0:IntPtr;OOQ0C00OQ0:ub4;OQQ0C00OQ0:OCIDuration;
OCQ0C00OQ0:OCITypeGetOpt;var O0C0C00OQ0:pOCIType):sword;cdecl;
var
OOC0C00OQ0:OOO0CQQOQ0;
OQC0C00OQ0,OCC0C00OQ0:string;
O00OC00OQ0:O0Q0QQOOQ0;
begin
OOC0C00OQ0:=OOO0CQQOQ0(GetGCHandleTarget(OC00C00OQ0));
OQC0C00OQ0:=O0CQCQOOQ0(OOC0C00OQ0.OOCOQOQOQ0.O00CQ0COQ0,O0O0C00OQ0,OOO0C00OQ0);
OCC0C00OQ0:=O0CQCQOOQ0(OOC0C00OQ0.OOCOQOQOQ0.O00CQ0COQ0,OQO0C00OQ0,OCO0C00OQ0);
try
O00OC00OQ0:=O0Q0QQOOQ0(OOC0C00OQ0.OQQ0QOQOQ0(OQC0C00OQ0,OCC0C00OQ0,OQ00C00OQ0));
if O00OC00OQ0<>nil then
O0C0C00OQ0:=O00OC00OQ0.OQQOQOCOQ0
else
O0C0C00OQ0:=nil;
Result:=OCI_SUCCESS;
except
on E:Exception do begin
O0C0C00OQ0:=nil;
Result:=OOC0C00OQ0.OOOCQOQOQ0(E,OQ00C00OQ0);
end;
end;
end;
function OCIObjectNew_(OO0OC00OQ0:pOCIEnv;OQ0OC00OQ0:pOCIError;const OC0OC00OQ0:pOCISvcCtx;
O0OOC00OQ0:OCITypeCode;OOOOC00OQ0:pOCIType;OQOOC00OQ0:IntPtr;
OCOOC00OQ0:OCIDuration;O0QOC00OQ0:tbool;var OOQOC00OQ0:IntPtr):sword;cdecl;
var
OQQOC00OQ0:O0CQQ0COQ0;
OCQOC00OQ0:O0Q0QQOOQ0;
O0COC00OQ0:O0CCCOOOQ0;
begin
OQQOC00OQ0:=O0CQQ0COQ0(GetGCHandleTarget(OO0OC00OQ0));
if O0OOC00OQ0=OCI_TYPECODE_VARCHAR then
OOQOC00OQ0:=OCQOC0QOQ0.Create(OQQOC00OQ0).OQQOQOCOQ0
else begin
OCQOC00OQ0:=O0Q0QQOOQ0(GetGCHandleTarget(OOOOC00OQ0));
if OCQOC00OQ0.OCCQCOOOQ0<>OCI_TYPECODE_OPAQUE then
O0COC00OQ0:=OCQOC00OQ0.OQCO0OOOQ0(OCOOC00OQ0)
else if(OCQOC00OQ0.OQQQCOOOQ0<>'ANYDATA')or(OCQOC00OQ0.OOQQCOOOQ0<>'SYS')then
O0COC00OQ0:=OCQOC00OQ0.OQCO0OOOQ0(OCOOC00OQ0)
else
O0COC00OQ0:=nil;
if O0COC00OQ0<>nil then
OOQOC00OQ0:=O0COC00OQ0.OQQOQOCOQ0
else
OOQOC00OQ0:=nil;
end;
Result:=OCI_SUCCESS;
end;
function OCIObjectCopy_(OOCOC00OQ0:pOCIEnv;OQCOC00OQ0:pOCIError;const OCCOC00OQ0:pOCISvcCtx;
O00QQ00OQ0:IntPtr;OO0QQ00OQ0:IntPtr;OQ0QQ00OQ0:IntPtr;
OC0QQ00OQ0:IntPtr;O0OQQ00OQ0:pOCIType;OOOQQ00OQ0:OCIDuration;
OQOQQ00OQ0:ub1):sword;cdecl;
var
OCOQQ00OQ0:O0CCCOOOQ0;
O0QQQ00OQ0:O0CCCOOOQ0;
begin
OCOQQ00OQ0:=O0CCCOOOQ0(GetGCHandleTarget(O00QQ00OQ0));
O0QQQ00OQ0:=O0CCCOOOQ0(GetGCHandleTarget(OQ0QQ00OQ0));
O0QQQ00OQ0.OCCCQOOOQ0(OCOQQ00OQ0);
Result:=OCI_SUCCESS;
end;
function OCIObjectFree_(OOQQQ00OQ0:pOCIEnv;OQQQQ00OQ0:pOCIError;OCQQQ00OQ0:IntPtr;
O0CQQ00OQ0:ub2):sword;cdecl;
var
OOCQQ00OQ0:O0CCQOCOQ0;
begin
OOCQQ00OQ0:=O0CCQOCOQ0(GetGCHandleTarget(OCQQQ00OQ0));
if OOCQQ00OQ0<>nil then
OOCQQ00OQ0.OCQ0QOCOQ0;
Result:=OCI_SUCCESS;
end;
function OCIObjectPtr_(OQCQQ00OQ0:pOCIEnv;OCCQQ00OQ0:pOCIError;O00CQ00OQ0:IntPtr):IntPtr;
var
OO0CQ00OQ0:O0CCCOOOQ0;
OQ0CQ00OQ0:OOQ0QOOOQ0;
begin
OO0CQ00OQ0:=O0CCCOOOQ0(GetGCHandleTarget(O00CQ00OQ0));
if(OO0CQ00OQ0<>nil)and(OO0CQ00OQ0.OO00QOOOQ0<>nil)then
if OO0CQ00OQ0.OO00QOOOQ0.OCCQCOOOQ0=OCI_TYPECODE_OBJECT then begin
OQ0CQ00OQ0:=OOQ0QOOOQ0(OO0CQ00OQ0);
if Length(OQ0CQ00OQ0.OO0OQOOOQ0)>0 then
Result:=@OQ0CQ00OQ0.OO0OQOOOQ0[0]
else
Result:=nil;
end
else
Result:=O00CQ00OQ0
else
Result:=nil;
end;
function OCIObjectGetInd_(OC0CQ00OQ0:pOCIEnv;O0OCQ00OQ0:pOCIError;OOOCQ00OQ0:IntPtr;
OQOCQ00OQ0:IntPtr):sword;cdecl;
var
OCOCQ00OQ0:O0CCCOOOQ0;
begin
OCOCQ00OQ0:=O0CCCOOOQ0(GetGCHandleTarget(OOOCQ00OQ0));
Marshal.WriteIntPtr(OQOCQ00OQ0,OCOCQ00OQ0.OC00QOOOQ0);
Result:=OCI_SUCCESS;
end;
function OCIObjectSetAttr_(O0QCQ00OQ0:pOCIEnv;OOQCQ00OQ0:pOCIError;OQQCQ00OQ0:IntPtr;
OCQCQ00OQ0:IntPtr;O0CCQ00OQ0:pOCIType;OOCCQ00OQ0:IntPtr;
const OQCCQ00OQ0:pub4;const OCCCQ00OQ0:ub4;const O000Q00OQ0:pub4;
const OO00Q00OQ0:ub4;const OQ00Q00OQ0:OCIInd;
const OC00Q00OQ0:IntPtr;const O0O0Q00OQ0:IntPtr):sword;cdecl;
var
OOO0Q00OQ0:integer;
OQO0Q00OQ0:O0CQQ0COQ0;
OCO0Q00OQ0:O0Q0QQOOQ0;
O0Q0Q00OQ0:O0CCCOOOQ0;
OOQ0Q00OQ0:string;
OQQ0Q00OQ0:Integer;
OCQ0Q00OQ0:IntPtr;
O0C0Q00OQ0:IntPtr;
begin
OQO0Q00OQ0:=O0CQQ0COQ0(OQ0CQ0COQ0(GetGCHandleTarget(OOQCQ00OQ0)).OCQOQOCOQ0);
OCO0Q00OQ0:=O0Q0QQOOQ0(GetGCHandleTarget(O0CCQ00OQ0));
O0Q0Q00OQ0:=O0CCCOOOQ0(GetGCHandleTarget(OQQCQ00OQ0));
for OOO0Q00OQ0:=0 to OCCCQ00OQ0-1 do begin
OOQ0Q00OQ0:=O0CQCQOOQ0(OQO0Q00OQ0.O00CQ0COQ0,Marshal.ReadIntPtr(OOCCQ00OQ0,SizeOf(IntPtr)*OOO0Q00OQ0),Marshal.ReadInt32(OQCCQ00OQ0,SizeOf(IntPtr)*OOO0Q00OQ0));
OQQ0Q00OQ0:=OCO0Q00OQ0.OQQO0OOOQ0(OOQ0Q00OQ0);
if OQQ0Q00OQ0>=0 then begin
OCQ0Q00OQ0:=O0Q0Q00OQ0.O0Q0QOOOQ0[OQQ0Q00OQ0];
O0C0Q00OQ0:=O0Q0Q00OQ0.OQO0QOOOQ0[OQQ0Q00OQ0];
if O0O0Q00OQ0<>nil then
Marshal.WriteIntPtr(OCQ0Q00OQ0,O0O0Q00OQ0);
Marshal.WriteInt16(O0C0Q00OQ0,OQ00Q00OQ0);
end
else begin
Result:=OCI_ERROR;
Exit;
end;
end;
Result:=OCI_SUCCESS;
end;
function OCIObjectGetAttr_(OOC0Q00OQ0:pOCIEnv;OQC0Q00OQ0:pOCIError;OCC0Q00OQ0:IntPtr;
O00OQ00OQ0:IntPtr;OO0OQ00OQ0:pOCIType;OQ0OQ00OQ0:IntPtr;
const OC0OQ00OQ0:pub4;const O0OOQ00OQ0:ub4;const OOOOQ00OQ0:pub4;
const OQOOQ00OQ0:ub4;OCOOQ00OQ0:pOCIInd;
O0QOQ00OQ0:IntPtr;OOQOQ00OQ0:IntPtr;OQQOQ00OQ0:ppOCIType):sword;cdecl;
var
OCQOQ00OQ0:integer;
O0COQ00OQ0:O0CQQ0COQ0;
OOCOQ00OQ0:O0Q0QQOOQ0;
OQCOQ00OQ0:O0CCCOOOQ0;
OCCOQ00OQ0:string;
O00QOCC0Q0:Integer;
OO0QOCC0Q0:IntPtr;
OQ0QOCC0Q0:IntPtr;
begin
O0COQ00OQ0:=O0CQQ0COQ0(OQ0CQ0COQ0(GetGCHandleTarget(OQC0Q00OQ0)).OCQOQOCOQ0);
OOCOQ00OQ0:=O0Q0QQOOQ0(GetGCHandleTarget(OO0OQ00OQ0));
OQCOQ00OQ0:=O0CCCOOOQ0(GetGCHandleTarget(OCC0Q00OQ0));
for OCQOQ00OQ0:=0 to O0OOQ00OQ0-1 do begin
OCCOQ00OQ0:=O0CQCQOOQ0(O0COQ00OQ0.O00CQ0COQ0,Marshal.ReadIntPtr(OQ0OQ00OQ0,SizeOf(IntPtr)*OCQOQ00OQ0),Marshal.ReadInt32(OC0OQ00OQ0,SizeOf(IntPtr)*OCQOQ00OQ0));
O00QOCC0Q0:=OOCOQ00OQ0.OQQO0OOOQ0(OCCOQ00OQ0);
if O00QOCC0Q0>=0 then begin
OO0QOCC0Q0:=OQCOQ00OQ0.O0Q0QOOOQ0[O00QOCC0Q0];
OQ0QOCC0Q0:=OQCOQ00OQ0.OQO0QOOOQ0[O00QOCC0Q0];
if OOQOQ00OQ0<>nil then
Marshal.WriteIntPtr(OOQOQ00OQ0,Marshal.ReadIntPtr(OO0QOCC0Q0));
Marshal.WriteInt16(OCOOQ00OQ0,Marshal.ReadInt16(OQ0QOCC0Q0));
end
else begin
Result:=OCI_ERROR;
Exit;
end;
end;
Result:=OCI_SUCCESS;
end;
function OCIDefineObject_(OC0QOCC0Q0:pOCIDefine;O0OQOCC0Q0:pOCIError;const OOOQOCC0Q0:pOCIType;
OQOQOCC0Q0:IntPtr;OCOQOCC0Q0:pub4;O0QQOCC0Q0:IntPtr;OOQQOCC0Q0:pub4):sword;cdecl;
begin
Result:=OOCCQ0COQ0.OQ0C0QQOQ0(OC0QOCC0Q0,O0OQOCC0Q0,OOOQOCC0Q0,OQOQOCC0Q0,OCOQOCC0Q0,O0QQOCC0Q0,OOQQOCC0Q0);
end;
function OCIBindObject_(OQQQOCC0Q0:pOCIBind;OCQQOCC0Q0:pOCIError;const O0CQOCC0Q0:pOCIType;
OOCQOCC0Q0:IntPtr;OQCQOCC0Q0:pub4;OCCQOCC0Q0:IntPtr;O00COCC0Q0:pub4):sword;cdecl;
begin
Result:=OOCCQ0COQ0.O0QO0QQOQ0(OQQQOCC0Q0,OCQQOCC0Q0,O0CQOCC0Q0,OOCQOCC0Q0,OQCQOCC0Q0,OCCQOCC0Q0,O00COCC0Q0);
end;
function OCIRefIsNull_(OO0COCC0Q0:pOCIEnv;const OQ0COCC0Q0:pOCIRef):tbool;cdecl;
var
OC0COCC0Q0:O0CCCOOOQ0;
O0OCOCC0Q0:OQOCO0OOQ0;
begin
OC0COCC0Q0:=O0CCCOOOQ0(GetGCHandleTarget(OQ0COCC0Q0));
O0OCOCC0Q0:=OQOCO0OOQ0(OC0COCC0Q0);
if sb2(O0OCOCC0Q0.O0O0QOOOQ0^)=OCI_IND_NULL then
Result:=1
else
Result:=0;
end;
function OCIObjectPin2_(OOOCOCC0Q0:pOCIEnv;const OQOCOCC0Q0:pOCISvcCtx;OCOCOCC0Q0:pOCIError;O0QCOCC0Q0:pOCIRef;
OOQCOCC0Q0:pOCIComplexObject;OQQCOCC0Q0:OCIPinOpt;OCQCOCC0Q0:OCIDuration;
O0CCOCC0Q0:OCILockOpt;OOCCOCC0Q0:IntPtr):sword;
var
OQCCOCC0Q0:O0CCCOOOQ0;
OCCCOCC0Q0:OQOCO0OOQ0;
O000OCC0Q0:OOQ0QOOOQ0;
begin
OQCCOCC0Q0:=O0CCCOOOQ0(GetGCHandleTarget(O0QCOCC0Q0));
OCCCOCC0Q0:=OQOCO0OOQ0(OQCCOCC0Q0);
if sb2(OCCCOCC0Q0.O0O0QOOOQ0^)<>OCI_IND_NULL then begin
O000OCC0Q0:=OCCCOCC0Q0.OOQCO0OOQ0(OOO0CQQOQ0(GetGCHandleTarget(OQOCOCC0Q0)),OCOCOCC0Q0);
IntPtr(OOCCOCC0Q0^):=O000OCC0Q0.OQQOQOCOQ0;
end
else
IntPtr(OOCCOCC0Q0^):=nil;
Result:=OCI_SUCCESS;
end;
function OCITableSize_(OO00OCC0Q0:pOCIEnv;OQ00OCC0Q0:pOCIError;const OC00OCC0Q0:pOCITable;
var O0O0OCC0Q0:sb4):sword;cdecl;
var
OOO0OCC0Q0:OOOQ00OOQ0;
begin
OOO0OCC0Q0:=OOOQ00OOQ0(GetGCHandleTarget(OC00OCC0Q0));
O0O0OCC0Q0:=OOO0OCC0Q0.OQC0O0OOQ0;
Result:=OCI_SUCCESS;
end;
function OCITableNext_(OQO0OCC0Q0:pOCIEnv;OCO0OCC0Q0:pOCIError;O0Q0OCC0Q0:sb4;const OOQ0OCC0Q0:pOCITable;
var OQQ0OCC0Q0:sb4;var OCQ0OCC0Q0:tbool):sword;cdecl;
var
O0C0OCC0Q0:OOOQ00OOQ0;
begin
O0C0OCC0Q0:=OOOQ00OOQ0(GetGCHandleTarget(OOQ0OCC0Q0));
if O0C0OCC0Q0.OQC0O0OOQ0=0 then begin
OCQ0OCC0Q0:=0;
OQQ0OCC0Q0:=O0Q0OCC0Q0;
end
else if O0Q0OCC0Q0+1<O0C0OCC0Q0.OQC0O0OOQ0 then begin
OCQ0OCC0Q0:=1;
OQQ0OCC0Q0:=O0Q0OCC0Q0+1;
end
else begin
OCQ0OCC0Q0:=0;
OQQ0OCC0Q0:=O0Q0OCC0Q0;
end;
Result:=OCI_SUCCESS;
end;
function OCITableDelete_(OOC0OCC0Q0:pOCIEnv;OQC0OCC0Q0:pOCIError;OCC0OCC0Q0:sb4;O00OOCC0Q0:pOCITable):sword;cdecl;
var
OO0OOCC0Q0:OOOQ00OOQ0;
begin
OO0OOCC0Q0:=OOOQ00OOQ0(GetGCHandleTarget(O00OOCC0Q0));
OO0OOCC0Q0.OO0C00OOQ0(OCC0OCC0Q0);
Result:=OCI_SUCCESS;
end;
function OCICollSize_(OQ0OOCC0Q0:pOCIEnv;OC0OOCC0Q0:pOCIError;const O0OOOCC0Q0:pOCIColl;
var OOOOOCC0Q0:sb4):sword;cdecl;
var
OQOOOCC0Q0:OOO0O0OOQ0;
begin
OQOOOCC0Q0:=OOO0O0OOQ0(GetGCHandleTarget(O0OOOCC0Q0));
OOOOOCC0Q0:=OQOOOCC0Q0.OQC0O0OOQ0;
Result:=OCI_SUCCESS;
end;
function OCICollTrim_(OCOOOCC0Q0:pOCIEnv;O0QOOCC0Q0:pOCIError;OOQOOCC0Q0:sb4;
OQQOOCC0Q0:pOCIColl):sword;cdecl;
var
OCQOOCC0Q0:OOO0O0OOQ0;
O0COOCC0Q0:sb4;
begin
OCQOOCC0Q0:=OOO0O0OOQ0(GetGCHandleTarget(OQQOOCC0Q0));
O0COOCC0Q0:=OCQOOCC0Q0.OQC0O0OOQ0;
if OOQOOCC0Q0<=O0COOCC0Q0 then begin
OCQOOCC0Q0.O0C0O0OOQ0(OOQOOCC0Q0);
Result:=OCI_SUCCESS;
end
else
Result:=OCI_ERROR;
end;
function OCICollAppend_(OOCOOCC0Q0:pOCIEnv;OQCOOCC0Q0:pOCIError;const OCCOOCC0Q0:IntPtr;
const O00Q0CC0Q0:IntPtr;OO0Q0CC0Q0:pOCIColl):sword;cdecl;
var
OQ0Q0CC0Q0:OOO0O0OOQ0;
OC0Q0CC0Q0:OCCQQQOOQ0;
O0OQ0CC0Q0:IntPtr;
OOOQ0CC0Q0:IntPtr;
OQOQ0CC0Q0:tbool;
begin
OQ0Q0CC0Q0:=OOO0O0OOQ0(GetGCHandleTarget(OO0Q0CC0Q0));
if OQ0Q0CC0Q0.OCQ0O0OOQ0 then begin
if(OCCOOCC0Q0<>nil)and(O00Q0CC0Q0<>nil)then begin
Result:=OCICollGetElem_(OOCOOCC0Q0,OQCOOCC0Q0,OO0Q0CC0Q0,OQ0Q0CC0Q0.OQC0O0OOQ0-1,OQOQ0CC0Q0,O0OQ0CC0Q0,OOOQ0CC0Q0);
if Result<>0 then
Exit;
if OQOQ0CC0Q0=1 then begin
OC0Q0CC0Q0:=OQ0Q0CC0Q0.OO00QOOOQ0.O00CCOOOQ0;
if OC0Q0CC0Q0.O00OO0COQ0<>nil then
OQ0Q0CC0Q0.OOCOCOOOQ0(OC0Q0CC0Q0,@OCCOOCC0Q0,O00Q0CC0Q0,O0OQ0CC0Q0,OOOQ0CC0Q0)
else
OQ0Q0CC0Q0.OOCOCOOOQ0(OC0Q0CC0Q0,OCCOOCC0Q0,O00Q0CC0Q0,O0OQ0CC0Q0,OOOQ0CC0Q0);
Result:=OCI_SUCCESS;
end
else
Result:=OCI_ERROR;
end
else
Result:=OCI_SUCCESS;
end
else
Result:=OCI_ERROR;
end;
function OCICollAssign_(OCOQ0CC0Q0:pOCIEnv;O0QQ0CC0Q0:pOCIError;const OOQQ0CC0Q0:pOCIColl;
OQQQ0CC0Q0:pOCIColl):sword;cdecl;
var
OCQQ0CC0Q0:OOO0O0OOQ0;
O0CQ0CC0Q0:OOO0O0OOQ0;
begin
OCQQ0CC0Q0:=OOO0O0OOQ0(GetGCHandleTarget(OOQQ0CC0Q0));
O0CQ0CC0Q0:=OOO0O0OOQ0(GetGCHandleTarget(OQQQ0CC0Q0));
O0CQ0CC0Q0.OCCCQOOOQ0(OCQQ0CC0Q0);
Result:=OCI_SUCCESS;
end;
function OCICollAssignElem_(OOCQ0CC0Q0:pOCIEnv;OQCQ0CC0Q0:pOCIError;OCCQ0CC0Q0:sb4;
const O00C0CC0Q0:IntPtr;const OO0C0CC0Q0:IntPtr;OQ0C0CC0Q0:pOCIColl):sword;cdecl;
var
OC0C0CC0Q0:OOO0O0OOQ0;
O0OC0CC0Q0:OCCQQQOOQ0;
OOOC0CC0Q0:IntPtr;
OQOC0CC0Q0:IntPtr;
OCOC0CC0Q0:tbool;
begin
OC0C0CC0Q0:=OOO0O0OOQ0(GetGCHandleTarget(OQ0C0CC0Q0));
Result:=OCICollGetElem_(OOCQ0CC0Q0,OQCQ0CC0Q0,OQ0C0CC0Q0,OCCQ0CC0Q0,OCOC0CC0Q0,OOOC0CC0Q0,OQOC0CC0Q0);
if Result<>0 then
Exit;
if OCOC0CC0Q0<>0 then begin
O0OC0CC0Q0:=OC0C0CC0Q0.OO00QOOOQ0.O00CCOOOQ0;
if O0OC0CC0Q0.O00OO0COQ0<>nil then
OC0C0CC0Q0.OOCOCOOOQ0(O0OC0CC0Q0,@O00C0CC0Q0,OO0C0CC0Q0,@OOOC0CC0Q0,OQOC0CC0Q0)
else
case O0OC0CC0Q0.OOO0QQOOQ0 of
OCI_TYPECODE_CHAR,
OCI_TYPECODE_NCHAR,
OCI_TYPECODE_VARCHAR,
OCI_TYPECODE_VARCHAR2,
OCI_TYPECODE_NVARCHAR2:
OC0C0CC0Q0.OOCOCOOOQ0(O0OC0CC0Q0,@O00C0CC0Q0,OO0C0CC0Q0,OOOC0CC0Q0,OQOC0CC0Q0);
OCI_TYPECODE_TIMESTAMP,
OCI_TYPECODE_TIMESTAMP_TZ,
OCI_TYPECODE_TIMESTAMP_LTZ:
OC0C0CC0Q0.OOCOCOOOQ0(O0OC0CC0Q0,@O00C0CC0Q0,OO0C0CC0Q0,OOOC0CC0Q0,OQOC0CC0Q0);
OCI_TYPECODE_INTERVAL_YM,
OCI_TYPECODE_INTERVAL_DS:
OC0C0CC0Q0.OOCOCOOOQ0(O0OC0CC0Q0,@O00C0CC0Q0,OO0C0CC0Q0,OOOC0CC0Q0,OQOC0CC0Q0);
OCI_TYPECODE_BLOB,
OCI_TYPECODE_CLOB,
OCI_TYPECODE_NCLOB,
OCI_TYPECODE_BFILE,
OCI_TYPECODE_CFILE:
OC0C0CC0Q0.OOCOCOOOQ0(O0OC0CC0Q0,@O00C0CC0Q0,OO0C0CC0Q0,OOOC0CC0Q0,OQOC0CC0Q0);
else
OC0C0CC0Q0.OOCOCOOOQ0(O0OC0CC0Q0,O00C0CC0Q0,OO0C0CC0Q0,OOOC0CC0Q0,OQOC0CC0Q0);
end;
Result:=OCI_SUCCESS;
end
else
Result:=OCI_ERROR;
end;
function OCICollGetElem_(O0QC0CC0Q0:pOCIEnv;OOQC0CC0Q0:pOCIError;const OQQC0CC0Q0:pOCIColl;
OCQC0CC0Q0:sb4;var O0CC0CC0Q0:tbool;var OOCC0CC0Q0:IntPtr;var OQCC0CC0Q0:IntPtr):sword;cdecl;
var
OCCC0CC0Q0:OOO0O0OOQ0;
O0000CC0Q0:O0CCCOOOQ0;
OO000CC0Q0:O0Q0QQOOQ0;
begin
OCCC0CC0Q0:=OOO0O0OOQ0(GetGCHandleTarget(OQQC0CC0Q0));
if OCQC0CC0Q0<OCCC0CC0Q0.OQC0O0OOQ0 then begin
OOCC0CC0Q0:=OCCC0CC0Q0.O0Q0QOOOQ0[OCQC0CC0Q0];
OQCC0CC0Q0:=OCCC0CC0Q0.OQO0QOOOQ0[OCQC0CC0Q0];
OO000CC0Q0:=OCCC0CC0Q0.OO00QOOOQ0.O00CCOOOQ0.O00OO0COQ0;
if OO000CC0Q0<>nil then begin
O0000CC0Q0:=O0CCCOOOQ0(GetGCHandleTarget(Marshal.ReadIntPtr(OOCC0CC0Q0)));
OQCC0CC0Q0:=O0000CC0Q0.O0O0QOOOQ0;
end;
O0CC0CC0Q0:=1;
end
else begin
OOCC0CC0Q0:=nil;
OQCC0CC0Q0:=nil;
O0CC0CC0Q0:=0;
end;
Result:=OCI_SUCCESS;
end;
function OCIXMLTypeNew_(OQ000CC0Q0:pOCISvcCtx;OC000CC0Q0:pOCIError;O0O00CC0Q0:OCIDuration;
OOO00CC0Q0:PAnsiChar;OQO00CC0Q0:ub4;OCO00CC0Q0:PAnsiChar;
O0Q00CC0Q0:ub4;var OOQ00CC0Q0:pOCIXMLType):sword;cdecl;
var
OQQ00CC0Q0:OOO0CQQOQ0;
OCQ00CC0Q0:O0Q0QQOOQ0;
O0C00CC0Q0:OOOOQOOOQ0;
begin
OQQ00CC0Q0:=OOO0CQQOQ0(GetGCHandleTarget(OQ000CC0Q0));
OCQ00CC0Q0:=O0Q0QQOOQ0(OQQ00CC0Q0.OQQ0QOQOQ0('SYS','XMLTYPE',OC000CC0Q0));
O0C00CC0Q0:=OOOOQOOOQ0.Create(OQQ00CC0Q0.OOCOQOQOQ0,OCQ00CC0Q0,O0O00CC0Q0);
OOQ00CC0Q0:=O0C00CC0Q0.OQQOQOCOQ0;
Result:=OCI_SUCCESS;
end;
function OCIXMLTypeCreateFromSrc_(OOC00CC0Q0:pOCISvcCtx;OQC00CC0Q0:pOCIError;OCC00CC0Q0:OCIDuration;
O00O0CC0Q0:ub1;OO0O0CC0Q0:IntPtr;OQ0O0CC0Q0:sb4;var OC0O0CC0Q0:pOCIXMLType):sword;cdecl;
var
O0OO0CC0Q0:OOO0CQQOQ0;
OOOO0CC0Q0:O0Q0QQOOQ0;
OQOO0CC0Q0:OOOOQOOOQ0;
OCOO0CC0Q0:OCQOC0QOQ0;
O0QO0CC0Q0:OOCCQ0QOQ0;
OOQO0CC0Q0:string;
begin
O0OO0CC0Q0:=OOO0CQQOQ0(GetGCHandleTarget(OOC00CC0Q0));
OOOO0CC0Q0:=O0Q0QQOOQ0(O0OO0CC0Q0.OQQ0QOQOQ0('SYS','XMLTYPE',OQC00CC0Q0));
OQOO0CC0Q0:=OOOOQOOOQ0.Create(O0OO0CC0Q0.OOCOQOQOQ0,OOOO0CC0Q0,OCC00CC0Q0);
case O00O0CC0Q0 of
OCI_XMLTYPE_CREATE_OCISTRING:begin
OCOO0CC0Q0:=OCQOC0QOQ0(GetGCHandleTarget(OO0O0CC0Q0));
OOQO0CC0Q0:=OCOO0CC0Q0.OQQCQ0QOQ0;
Result:=OCOCOC0OQ0.OOCCOC0OQ0(O0OO0CC0Q0,OOQO0CC0Q0,OQOO0CC0Q0,OQC00CC0Q0);
end;
OCI_XMLTYPE_CREATE_CLOB:begin
O0QO0CC0Q0:=OOCCQ0QOQ0(GetGCHandleTarget(OO0O0CC0Q0));
Result:=OCOCOC0OQ0.OCO0OC0OQ0(O0OO0CC0Q0,O0QO0CC0Q0,OQOO0CC0Q0,OQC00CC0Q0);
end;
else
Result:=OCI_ERROR;
end;
if Result=0 then begin
OQOO0CC0Q0.OOO0QOOOQ0:=OCI_IND_NOTNULL;
OC0O0CC0Q0:=OQOO0CC0Q0.OQQOQOCOQ0;
end
else begin
OQOO0CC0Q0.OCQ0QOCOQ0;
OC0O0CC0Q0:=nil;
end;
end;
function OCIPStreamFromXMLType_(OQQO0CC0Q0:pOCIError;OCQO0CC0Q0:IntPtr;
O0CO0CC0Q0:IntPtr;OOCO0CC0Q0:integer):sword;cdecl;
var
OQCO0CC0Q0:OOO0CQQOQ0;
OCCO0CC0Q0:OCOCOC0OQ0;
O00QCCC0Q0:OOOOQOOOQ0;
OO0QCCC0Q0:OOCCQ0QOQ0;
OQ0QCCC0Q0:ub4;
begin
OCCO0CC0Q0:=OCOCOC0OQ0(GetGCHandleTarget(OCQO0CC0Q0));
OCCO0CC0Q0.O0CCOC0OQ0;
O00QCCC0Q0:=OOOOQOOOQ0(GetGCHandleTarget(O0CO0CC0Q0));
OQCO0CC0Q0:=O00QCCC0Q0.OO00QOOOQ0.O0QQCOOOQ0;
if(O00QCCC0Q0.OOO0QOOOQ0=OCI_IND_NOTNULL)and(Length(O00QCCC0Q0.O0OOQOOOQ0)>0)then begin
Result:=OCOCOC0OQ0.OQQOOC0OQ0(OQCO0CC0Q0,O00QCCC0Q0,OO0QCCC0Q0,OQQO0CC0Q0);
if Result=OCI_SUCCESS then begin
Result:=OO0QCCC0Q0.O0QC0COOQ0(OQCO0CC0Q0.OQQOQOCOQ0,OQQO0CC0Q0,OQ0QCCC0Q0);
if Result=OCI_SUCCESS then begin
OCCO0CC0Q0.O0OQ0C0OQ0:=OO0QCCC0Q0;
if OQCO0CC0Q0.OOCOQOQOQ0.O00CQ0COQ0 then
OCCO0CC0Q0.OOOQ0C0OQ0:=OQ0QCCC0Q0*2
else
OCCO0CC0Q0.OOOQ0C0OQ0:=OQ0QCCC0Q0;
OCCO0CC0Q0.OC0Q0C0OQ0:=OQCO0CC0Q0;
OCCO0CC0Q0.OQOQ0C0OQ0:=0;
end;
end;
if Result=OCI_NO_DATA then
Result:=OCI_SUCCESS;
end
else
Result:=OCI_SUCCESS;
end;
function OCIPStreamRead_(OC0QCCC0Q0:pOCIError;O0OQCCC0Q0:IntPtr;
OOOQCCC0Q0:IntPtr;var OQOQCCC0Q0:int64;OCOQCCC0Q0:integer):sword;cdecl;
var
O0QQCCC0Q0:OOO0CQQOQ0;
OOQQCCC0Q0:OCOCOC0OQ0;
OQQQCCC0Q0:ub4;
OCQQCCC0Q0:ub4;
begin
O0QQCCC0Q0:=OCOCOC0OQ0(GetGCHandleTarget(O0OQCCC0Q0)).OC0Q0C0OQ0;
OOQQCCC0Q0:=OCOCOC0OQ0(GetGCHandleTarget(O0OQCCC0Q0));
if(OOQQCCC0Q0.O0OQ0C0OQ0<>nil)and(OOQQCCC0Q0.OQOQ0C0OQ0<OOQQCCC0Q0.OOOQ0C0OQ0)then begin
if O0QQCCC0Q0.OOCOQOQOQ0.O00CQ0COQ0 then begin
OQQQCCC0Q0:=OQOQCCC0Q0 shr 1;
OCQQCCC0Q0:=(OOQQCCC0Q0.OQOQ0C0OQ0 shr 1)+1;
Result:=OOQQCCC0Q0.O0OQ0C0OQ0.OQCC0COOQ0(O0QQCCC0Q0.OQQOQOCOQ0,OC0QCCC0Q0,OQQQCCC0Q0,OCQQCCC0Q0,OOOQCCC0Q0,OQOQCCC0Q0,OCOCCOCOQ0,OOQQCCC0Q0.O0OQ0C0OQ0.OCC0OQOOQ0);
OQQQCCC0Q0:=OQQQCCC0Q0*2;
end
else begin
OQQQCCC0Q0:=OQOQCCC0Q0;
OCQQCCC0Q0:=OOQQCCC0Q0.OQOQ0C0OQ0+1;
Result:=OOQQCCC0Q0.O0OQ0C0OQ0.OQCC0COOQ0(O0QQCCC0Q0.OQQOQOCOQ0,OC0QCCC0Q0,OQQQCCC0Q0,OCQQCCC0Q0,OOOQCCC0Q0,OQOQCCC0Q0,0,OOQQCCC0Q0.O0OQ0C0OQ0.OCC0OQOOQ0);
end;
if Result=0 then begin
OOQQCCC0Q0.OQOQ0C0OQ0:=OOQQCCC0Q0.OQOQ0C0OQ0+OQQQCCC0Q0;
OQOQCCC0Q0:=OQQQCCC0Q0;
end
else
OQOQCCC0Q0:=0;
end
else begin
OQOQCCC0Q0:=0;
Result:=OCI_SUCCESS;
end;
end;
function OCIPStreamClose_(O0CQCCC0Q0:pOCIError;OOCQCCC0Q0:IntPtr):sword;cdecl;
var
OQCQCCC0Q0:OCOCOC0OQ0;
begin
OQCQCCC0Q0:=OCOCOC0OQ0(GetGCHandleTarget(OOCQCCC0Q0));
OQCQCCC0Q0.O0CCOC0OQ0;
Result:=OCI_SUCCESS;
end;
function OCIAnyDataAccess_(OCCQCCC0Q0:pOCISvcCtx;O00CCCC0Q0:pOCIError;OO0CCCC0Q0:pOCIAnyData;
OQ0CCCC0Q0:OCITypeCode;OC0CCCC0Q0:pOCIType;O0OCCCC0Q0:IntPtr;
out OOOCCCC0Q0:IntPtr;out OQOCCCC0Q0:ub4):sword;cdecl;
var
OCOCCCC0Q0:OOO0CQQOQ0;
O0QCCCC0Q0:OQOOQOOOQ0;
begin
OCOCCCC0Q0:=OOO0CQQOQ0(GetGCHandleTarget(OCCQCCC0Q0));
O0QCCCC0Q0:=OQOOQOOOQ0(GetGCHandleTarget(OO0CCCC0Q0));
if O0QCCCC0Q0.OC0CO0OOQ0<>nil then begin
OQOCCCC0Q0:=O0QCCCC0Q0.OC0CO0OOQ0.OO00O0COQ0;
if OQOCCCC0Q0>0 then
OOOCCCC0Q0:=O0QCCCC0Q0.O00QO0OOQ0(OCOCCCC0Q0,O00CCCC0Q0)
else
OOOCCCC0Q0:=nil;
end
else begin
OQOCCCC0Q0:=0;
OOOCCCC0Q0:=nil;
end;
if O0QCCCC0Q0.OOOCO0OOQ0<>nil then
Marshal.WriteIntPtr(O0OCCCC0Q0,O0QCCCC0Q0.OOOCO0OOQ0)
else
Marshal.WriteIntPtr(O0OCCCC0Q0,nil);
Result:=OCI_SUCCESS;
end;
function OCIAnyDataConvert_(OOQCCCC0Q0:pOCISvcCtx;OQQCCCC0Q0:pOCIError;OCQCCCC0Q0:OCITypeCode;
O0CCCCC0Q0:pOCIType;OOCCCCC0Q0:OCIDuration;OQCCCCC0Q0:IntPtr;OCCCCCC0Q0:IntPtr;O000CCC0Q0:ub4;
OO00CCC0Q0:IntPtr):sword;cdecl;
var
OQ00CCC0Q0:OOO0CQQOQ0;
OC00CCC0Q0:OQOOQOOOQ0;
O0O0CCC0Q0:O0Q0QQOOQ0;
OOO0CCC0Q0:O0Q0QQOOQ0;
begin
OQ00CCC0Q0:=OOO0CQQOQ0(GetGCHandleTarget(OOQCCCC0Q0));
OC00CCC0Q0:=OQOOQOOOQ0(GetGCHandleTarget(Marshal.ReadIntPtr(OO00CCC0Q0)));
O0O0CCC0Q0:=O0Q0QQOOQ0(GetGCHandleTarget(O0CCCCC0Q0));
if OC00CCC0Q0=nil then begin
OOO0CCC0Q0:=O0Q0QQOOQ0(OQ00CCC0Q0.OQQ0QOQOQ0('SYS','ANYDATA',OQQCCCC0Q0));
OC00CCC0Q0:=OQOOQOOOQ0.Create(OQ00CCC0Q0.OCQOQOCOQ0,OOO0CCC0Q0,OOCCCCC0Q0)
end
else
OC00CCC0Q0.OOCQQOOOQ0;
OC00CCC0Q0.OQCQO0OOQ0(OCQCCCC0Q0,O0O0CCC0Q0,O000CCC0Q0);
OC00CCC0Q0.OQOQO0OOQ0(OQ00CCC0Q0,OQQCCCC0Q0,OCCCCCC0Q0,O000CCC0Q0);
Marshal.WriteIntPtr(OO00CCC0Q0,OC00CCC0Q0.OQQOQOCOQ0);
Result:=OCI_SUCCESS;
end;
function OCIAnyDataGetType_(OQO0CCC0Q0:pOCISvcCtx;OCO0CCC0Q0:pOCIError;O0Q0CCC0Q0:pOCIAnyData;
out OOQ0CCC0Q0:OCITypeCode;out OQQ0CCC0Q0:pOCIType):sword;cdecl;
var
OCQ0CCC0Q0:OOO0CQQOQ0;
O0C0CCC0Q0:OQOOQOOOQ0;
OOC0CCC0Q0:O0Q0QQOOQ0;
begin
OCQ0CCC0Q0:=OOO0CQQOQ0(GetGCHandleTarget(OQO0CCC0Q0));
O0C0CCC0Q0:=OQOOQOOOQ0(GetGCHandleTarget(O0Q0CCC0Q0));
if O0C0CCC0Q0.OC0CO0OOQ0<>nil then begin
OOQ0CCC0Q0:=O0C0CCC0Q0.OC0CO0OOQ0.OOO0QQOOQ0;
OOC0CCC0Q0:=O0C0CCC0Q0.O0COQOOOQ0(OCQ0CCC0Q0,OCO0CCC0Q0);
if OOC0CCC0Q0<>nil then
OQQ0CCC0Q0:=OOC0CCC0Q0.OQQOQOCOQ0
else
OQQ0CCC0Q0:=nil;
end
else begin
OOQ0CCC0Q0:=0;
OQQ0CCC0Q0:=nil;
end;
Result:=OCI_SUCCESS;
end;
initialization
UseDirectLobs:=True;
UseFastSelect:=True;
AdvancedSecurity:=True;
EncryptionLevel:=slAccepted;
DataIntegrityLevel:=slAccepted;
PacketSize:=0;
SDU:=8192;
TDU:=32767;
OldAuthMode:=False;
OldAlterMode:=False;
OldRxdMode:=False;
end.
